"use strict";exports.id=310,exports.ids=[310],exports.modules={23310:(t,e,i)=>{i.r(e),i.d(e,{Header:()=>tN,Pack:()=>iT,PackJob:()=>ii,PackSync:()=>ik,Parser:()=>eT,Pax:()=>tq,ReadEntry:()=>t0,Unpack:()=>sO,UnpackSync:()=>sk,WriteEntry:()=>e8,WriteEntrySync:()=>e6,WriteEntryTar:()=>e9,c:()=>ix,create:()=>ix,extract:()=>sL,filesFilter:()=>eD,list:()=>ex,r:()=>sI,replace:()=>sI,t:()=>ex,types:()=>s,u:()=>sN,update:()=>sN,x:()=>sL});var s={};i.r(s),i.d(s,{code:()=>tI,isCode:()=>tD,isName:()=>tx,name:()=>tA});var r=i(94735),h=i(29021),n=i(68321);let o=h.writev,a=Symbol("_autoClose"),l=Symbol("_close"),d=Symbol("_ended"),u=Symbol("_fd"),c=Symbol("_finished"),m=Symbol("_flags"),p=Symbol("_flush"),f=Symbol("_handleChunk"),y=Symbol("_makeBuf"),b=Symbol("_mode"),E=Symbol("_needDrain"),g=Symbol("_onerror"),w=Symbol("_onopen"),R=Symbol("_onread"),_=Symbol("_onwrite"),S=Symbol("_open"),v=Symbol("_path"),O=Symbol("_pos"),T=Symbol("_queue"),k=Symbol("_read"),L=Symbol("_readSize"),D=Symbol("_reading"),x=Symbol("_remain"),A=Symbol("_size"),I=Symbol("_write"),N=Symbol("_writing"),F=Symbol("_defaultFlag"),B=Symbol("_errored");class C extends n.n_{[B]=!1;[u];[v];[L];[D]=!1;[A];[x];[a];constructor(t,e){if(super(e=e||{}),this.readable=!0,this.writable=!1,"string"!=typeof t)throw TypeError("path must be a string");this[B]=!1,this[u]="number"==typeof e.fd?e.fd:void 0,this[v]=t,this[L]=e.readSize||0x1000000,this[D]=!1,this[A]="number"==typeof e.size?e.size:1/0,this[x]=this[A],this[a]="boolean"!=typeof e.autoClose||e.autoClose,"number"==typeof this[u]?this[k]():this[S]()}get fd(){return this[u]}get path(){return this[v]}write(){throw TypeError("this is a readable stream")}end(){throw TypeError("this is a readable stream")}[S](){h.open(this[v],"r",(t,e)=>this[w](t,e))}[w](t,e){t?this[g](t):(this[u]=e,this.emit("open",e),this[k]())}[y](){return Buffer.allocUnsafe(Math.min(this[L],this[x]))}[k](){if(!this[D]){this[D]=!0;let t=this[y]();if(0===t.length)return process.nextTick(()=>this[R](null,0,t));h.read(this[u],t,0,t.length,null,(t,e,i)=>this[R](t,e,i))}}[R](t,e,i){this[D]=!1,t?this[g](t):this[f](e,i)&&this[k]()}[l](){if(this[a]&&"number"==typeof this[u]){let t=this[u];this[u]=void 0,h.close(t,t=>t?this.emit("error",t):this.emit("close"))}}[g](t){this[D]=!0,this[l](),this.emit("error",t)}[f](t,e){let i=!1;return this[x]-=t,t>0&&(i=super.write(t<e.length?e.subarray(0,t):e)),(0===t||this[x]<=0)&&(i=!1,this[l](),super.end()),i}emit(t,...e){switch(t){case"prefinish":case"finish":return!1;case"drain":return"number"==typeof this[u]&&this[k](),!1;case"error":if(this[B])return!1;return this[B]=!0,super.emit(t,...e);default:return super.emit(t,...e)}}}class M extends C{[S](){let t=!0;try{this[w](null,h.openSync(this[v],"r")),t=!1}finally{t&&this[l]()}}[k](){let t=!0;try{if(!this[D]){for(this[D]=!0;;){let t=this[y](),e=0===t.length?0:h.readSync(this[u],t,0,t.length,null);if(!this[f](e,t))break}this[D]=!1}t=!1}finally{t&&this[l]()}}[l](){if(this[a]&&"number"==typeof this[u]){let t=this[u];this[u]=void 0,h.closeSync(t),this.emit("close")}}}class P extends r{readable=!1;writable=!0;[B]=!1;[N]=!1;[d]=!1;[T]=[];[E]=!1;[v];[b];[a];[u];[F];[m];[c]=!1;[O];constructor(t,e){super(e=e||{}),this[v]=t,this[u]="number"==typeof e.fd?e.fd:void 0,this[b]=void 0===e.mode?438:e.mode,this[O]="number"==typeof e.start?e.start:void 0,this[a]="boolean"!=typeof e.autoClose||e.autoClose;let i=void 0!==this[O]?"r+":"w";this[F]=void 0===e.flags,this[m]=void 0===e.flags?i:e.flags,void 0===this[u]&&this[S]()}emit(t,...e){if("error"===t){if(this[B])return!1;this[B]=!0}return super.emit(t,...e)}get fd(){return this[u]}get path(){return this[v]}[g](t){this[l](),this[N]=!0,this.emit("error",t)}[S](){h.open(this[v],this[m],this[b],(t,e)=>this[w](t,e))}[w](t,e){this[F]&&"r+"===this[m]&&t&&"ENOENT"===t.code?(this[m]="w",this[S]()):t?this[g](t):(this[u]=e,this.emit("open",e),this[N]||this[p]())}end(t,e){return t&&this.write(t,e),this[d]=!0,this[N]||this[T].length||"number"!=typeof this[u]||this[_](null,0),this}write(t,e){return("string"==typeof t&&(t=Buffer.from(t,e)),this[d])?(this.emit("error",Error("write() after end()")),!1):void 0===this[u]||this[N]||this[T].length?(this[T].push(t),this[E]=!0,!1):(this[N]=!0,this[I](t),!0)}[I](t){h.write(this[u],t,0,t.length,this[O],(t,e)=>this[_](t,e))}[_](t,e){t?this[g](t):(void 0!==this[O]&&"number"==typeof e&&(this[O]+=e),this[T].length?this[p]():(this[N]=!1,this[d]&&!this[c]?(this[c]=!0,this[l](),this.emit("finish")):this[E]&&(this[E]=!1,this.emit("drain"))))}[p](){if(0===this[T].length)this[d]&&this[_](null,0);else if(1===this[T].length)this[I](this[T].pop());else{let t=this[T];this[T]=[],o(this[u],t,this[O],(t,e)=>this[_](t,e))}}[l](){if(this[a]&&"number"==typeof this[u]){let t=this[u];this[u]=void 0,h.close(t,t=>t?this.emit("error",t):this.emit("close"))}}}class z extends P{[S](){let t;if(this[F]&&"r+"===this[m])try{t=h.openSync(this[v],this[m],this[b])}catch(t){if(t?.code==="ENOENT")return this[m]="w",this[S]();throw t}else t=h.openSync(this[v],this[m],this[b]);this[w](null,t)}[l](){if(this[a]&&"number"==typeof this[u]){let t=this[u];this[u]=void 0,h.closeSync(t),this.emit("close")}}[I](t){let e=!0;try{this[_](null,h.writeSync(this[u],t,0,t.length,this[O])),e=!1}finally{if(e)try{this[l]()}catch{}}}}var U=i(76760),j=i(73024),H=i(33873);let Z=new Map([["C","cwd"],["f","file"],["z","gzip"],["P","preservePaths"],["U","unlink"],["strip-components","strip"],["stripComponents","strip"],["keep-newer","newer"],["keepNewer","newer"],["keep-newer-files","newer"],["keepNewerFiles","newer"],["k","keep"],["keep-existing","keep"],["keepExisting","keep"],["m","noMtime"],["no-mtime","noMtime"],["p","preserveOwner"],["L","follow"],["h","follow"],["onentry","onReadEntry"]]),G=t=>!!t.sync&&!!t.file,W=t=>!t.sync&&!!t.file,V=t=>!!t.sync&&!t.file,Y=t=>!t.sync&&!t.file,$=t=>!!t.file,q=t=>{let e=Z.get(t);return e||t},K=(t={})=>{if(!t)return{};let e={};for(let[i,s]of Object.entries(t))e[q(i)]=s;return void 0===e.chmod&&!1===e.noChmod&&(e.chmod=!0),delete e.noChmod,e},X=(t,e,i,s,r)=>Object.assign((h=[],n,o)=>{Array.isArray(h)&&(n=h,h={}),"function"==typeof n&&(o=n,n=void 0),n=n?Array.from(n):[];let a=K(h);if(r?.(a,n),G(a)){if("function"==typeof o)throw TypeError("callback not supported for sync tar functions");return t(a,n)}if(W(a)){let t=e(a,n),i=o||void 0;return i?t.then(()=>i(),i):t}if(V(a)){if("function"==typeof o)throw TypeError("callback not supported for sync tar functions");return i(a,n)}if(Y(a)){if("function"==typeof o)throw TypeError("callback only supported with file option");return s(a,n)}throw Error("impossible options??")},{syncFile:t,asyncFile:e,syncNoFile:i,asyncNoFile:s,validate:r});var Q=i(12412),J=i(79428),tt=i(74075),te=i.t(tt,2);let ti=tt.constants||{ZLIB_VERNUM:4736},ts=Object.freeze(Object.assign(Object.create(null),{Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_VERSION_ERROR:-6,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,DEFLATE:1,INFLATE:2,GZIP:3,GUNZIP:4,DEFLATERAW:5,INFLATERAW:6,UNZIP:7,BROTLI_DECODE:8,BROTLI_ENCODE:9,Z_MIN_WINDOWBITS:8,Z_MAX_WINDOWBITS:15,Z_DEFAULT_WINDOWBITS:15,Z_MIN_CHUNK:64,Z_MAX_CHUNK:1/0,Z_DEFAULT_CHUNK:16384,Z_MIN_MEMLEVEL:1,Z_MAX_MEMLEVEL:9,Z_DEFAULT_MEMLEVEL:8,Z_MIN_LEVEL:-1,Z_MAX_LEVEL:9,Z_DEFAULT_LEVEL:-1,BROTLI_OPERATION_PROCESS:0,BROTLI_OPERATION_FLUSH:1,BROTLI_OPERATION_FINISH:2,BROTLI_OPERATION_EMIT_METADATA:3,BROTLI_MODE_GENERIC:0,BROTLI_MODE_TEXT:1,BROTLI_MODE_FONT:2,BROTLI_DEFAULT_MODE:0,BROTLI_MIN_QUALITY:0,BROTLI_MAX_QUALITY:11,BROTLI_DEFAULT_QUALITY:11,BROTLI_MIN_WINDOW_BITS:10,BROTLI_MAX_WINDOW_BITS:24,BROTLI_LARGE_MAX_WINDOW_BITS:30,BROTLI_DEFAULT_WINDOW:22,BROTLI_MIN_INPUT_BLOCK_BITS:16,BROTLI_MAX_INPUT_BLOCK_BITS:24,BROTLI_PARAM_MODE:0,BROTLI_PARAM_QUALITY:1,BROTLI_PARAM_LGWIN:2,BROTLI_PARAM_LGBLOCK:3,BROTLI_PARAM_DISABLE_LITERAL_CONTEXT_MODELING:4,BROTLI_PARAM_SIZE_HINT:5,BROTLI_PARAM_LARGE_WINDOW:6,BROTLI_PARAM_NPOSTFIX:7,BROTLI_PARAM_NDIRECT:8,BROTLI_DECODER_RESULT_ERROR:0,BROTLI_DECODER_RESULT_SUCCESS:1,BROTLI_DECODER_RESULT_NEEDS_MORE_INPUT:2,BROTLI_DECODER_RESULT_NEEDS_MORE_OUTPUT:3,BROTLI_DECODER_PARAM_DISABLE_RING_BUFFER_REALLOCATION:0,BROTLI_DECODER_PARAM_LARGE_WINDOW:1,BROTLI_DECODER_NO_ERROR:0,BROTLI_DECODER_SUCCESS:1,BROTLI_DECODER_NEEDS_MORE_INPUT:2,BROTLI_DECODER_NEEDS_MORE_OUTPUT:3,BROTLI_DECODER_ERROR_FORMAT_EXUBERANT_NIBBLE:-1,BROTLI_DECODER_ERROR_FORMAT_RESERVED:-2,BROTLI_DECODER_ERROR_FORMAT_EXUBERANT_META_NIBBLE:-3,BROTLI_DECODER_ERROR_FORMAT_SIMPLE_HUFFMAN_ALPHABET:-4,BROTLI_DECODER_ERROR_FORMAT_SIMPLE_HUFFMAN_SAME:-5,BROTLI_DECODER_ERROR_FORMAT_CL_SPACE:-6,BROTLI_DECODER_ERROR_FORMAT_HUFFMAN_SPACE:-7,BROTLI_DECODER_ERROR_FORMAT_CONTEXT_MAP_REPEAT:-8,BROTLI_DECODER_ERROR_FORMAT_BLOCK_LENGTH_1:-9,BROTLI_DECODER_ERROR_FORMAT_BLOCK_LENGTH_2:-10,BROTLI_DECODER_ERROR_FORMAT_TRANSFORM:-11,BROTLI_DECODER_ERROR_FORMAT_DICTIONARY:-12,BROTLI_DECODER_ERROR_FORMAT_WINDOW_BITS:-13,BROTLI_DECODER_ERROR_FORMAT_PADDING_1:-14,BROTLI_DECODER_ERROR_FORMAT_PADDING_2:-15,BROTLI_DECODER_ERROR_FORMAT_DISTANCE:-16,BROTLI_DECODER_ERROR_DICTIONARY_NOT_SET:-19,BROTLI_DECODER_ERROR_INVALID_ARGUMENTS:-20,BROTLI_DECODER_ERROR_ALLOC_CONTEXT_MODES:-21,BROTLI_DECODER_ERROR_ALLOC_TREE_GROUPS:-22,BROTLI_DECODER_ERROR_ALLOC_CONTEXT_MAP:-25,BROTLI_DECODER_ERROR_ALLOC_RING_BUFFER_1:-26,BROTLI_DECODER_ERROR_ALLOC_RING_BUFFER_2:-27,BROTLI_DECODER_ERROR_ALLOC_BLOCK_TYPE_TREES:-30,BROTLI_DECODER_ERROR_UNREACHABLE:-31},ti)),tr=J.Buffer.concat,th=Object.getOwnPropertyDescriptor(J.Buffer,"concat"),tn=t=>t,to=th?.writable===!0||th?.set!==void 0?t=>{J.Buffer.concat=t?tn:tr}:t=>{},ta=Symbol("_superWrite");class tl extends Error{code;errno;constructor(t,e){super("zlib: "+t.message,{cause:t}),this.code=t.code,this.errno=t.errno,this.code||(this.code="ZLIB_ERROR"),this.message="zlib: "+t.message,Error.captureStackTrace(this,e??this.constructor)}get name(){return"ZlibError"}}let td=Symbol("flushFlag");class tu extends n.n_{#t=!1;#e=!1;#i;#s;#r;#h;#n;get sawError(){return this.#t}get handle(){return this.#h}get flushFlag(){return this.#i}constructor(t,e){if(!t||"object"!=typeof t)throw TypeError("invalid options for ZlibBase constructor");if(super(t),this.#i=t.flush??0,this.#s=t.finishFlush??0,this.#r=t.fullFlushFlag??0,"function"!=typeof te[e])throw TypeError("Compression method not supported: "+e);try{this.#h=new te[e](t)}catch(t){throw new tl(t,this.constructor)}this.#n=t=>{this.#t||(this.#t=!0,this.close(),this.emit("error",t))},this.#h?.on("error",t=>this.#n(new tl(t))),this.once("end",()=>this.close)}close(){this.#h&&(this.#h.close(),this.#h=void 0,this.emit("close"))}reset(){if(!this.#t)return Q(this.#h,"zlib binding closed"),this.#h.reset?.()}flush(t){this.ended||("number"!=typeof t&&(t=this.#r),this.write(Object.assign(J.Buffer.alloc(0),{[td]:t})))}end(t,e,i){return"function"==typeof t&&(i=t,e=void 0,t=void 0),"function"==typeof e&&(i=e,e=void 0),t&&(e?this.write(t,e):this.write(t)),this.flush(this.#s),this.#e=!0,super.end(i)}get ended(){return this.#e}[ta](t){return super.write(t)}write(t,e,i){let s,r;if("function"==typeof e&&(i=e,e="utf8"),"string"==typeof t&&(t=J.Buffer.from(t,e)),this.#t)return;Q(this.#h,"zlib binding closed");let h=this.#h._handle,n=h.close;h.close=()=>{};let o=this.#h.close;this.#h.close=()=>{},to(!0);try{let e="number"==typeof t[td]?t[td]:this.#i;r=this.#h._processChunk(t,e),to(!1)}catch(t){to(!1),this.#n(new tl(t,this.write))}finally{this.#h&&(this.#h._handle=h,h.close=n,this.#h.close=o,this.#h.removeAllListeners("error"))}if(this.#h&&this.#h.on("error",t=>this.#n(new tl(t,this.write))),r)if(Array.isArray(r)&&r.length>0){let t=r[0];s=this[ta](J.Buffer.from(t));for(let t=1;t<r.length;t++)s=this[ta](r[t])}else s=this[ta](J.Buffer.from(r));return i&&i(),s}}class tc extends tu{#o;#a;constructor(t,e){(t=t||{}).flush=t.flush||ts.Z_NO_FLUSH,t.finishFlush=t.finishFlush||ts.Z_FINISH,t.fullFlushFlag=ts.Z_FULL_FLUSH,super(t,e),this.#o=t.level,this.#a=t.strategy}params(t,e){if(!this.sawError){if(!this.handle)throw Error("cannot switch params when binding is closed");if(!this.handle.params)throw Error("not supported in this implementation");if(this.#o!==t||this.#a!==e){this.flush(ts.Z_SYNC_FLUSH),Q(this.handle,"zlib binding closed");let i=this.handle.flush;this.handle.flush=(t,e)=>{"function"==typeof t&&(e=t,t=this.flushFlag),this.flush(t),e?.()};try{this.handle.params(t,e)}finally{this.handle.flush=i}this.handle&&(this.#o=t,this.#a=e)}}}}class tm extends tc{#l;constructor(t){super(t,"Gzip"),this.#l=t&&!!t.portable}[ta](t){return this.#l&&(this.#l=!1,t[9]=255),super[ta](t)}}class tp extends tc{constructor(t){super(t,"Unzip")}}class tf extends tu{constructor(t,e){(t=t||{}).flush=t.flush||ts.BROTLI_OPERATION_PROCESS,t.finishFlush=t.finishFlush||ts.BROTLI_OPERATION_FINISH,t.fullFlushFlag=ts.BROTLI_OPERATION_FLUSH,super(t,e)}}class ty extends tf{constructor(t){super(t,"BrotliCompress")}}class tb extends tf{constructor(t){super(t,"BrotliDecompress")}}class tE extends tu{constructor(t,e){(t=t||{}).flush=t.flush||ts.ZSTD_e_continue,t.finishFlush=t.finishFlush||ts.ZSTD_e_end,t.fullFlushFlag=ts.ZSTD_e_flush,super(t,e)}}class tg extends tE{constructor(t){super(t,"ZstdCompress")}}class tw extends tE{constructor(t){super(t,"ZstdDecompress")}}let tR=(t,e)=>{if(Number.isSafeInteger(t))t<0?tS(t,e):t_(t,e);else throw Error("cannot encode number outside of javascript safe integer range");return e},t_=(t,e)=>{e[0]=128;for(var i=e.length;i>1;i--)e[i-1]=255&t,t=Math.floor(t/256)},tS=(t,e)=>{e[0]=255;var i=!1;t*=-1;for(var s=e.length;s>1;s--){var r=255&t;t=Math.floor(t/256),i?e[s-1]=tk(r):0===r?e[s-1]=0:(i=!0,e[s-1]=tL(r))}},tv=t=>{let e=t[0],i=128===e?tT(t.subarray(1,t.length)):255===e?tO(t):null;if(null===i)throw Error("invalid base256 encoding");if(!Number.isSafeInteger(i))throw Error("parsed number outside of javascript safe integer range");return i},tO=t=>{for(var e=t.length,i=0,s=!1,r=e-1;r>-1;r--){var h,n=Number(t[r]);s?h=tk(n):0===n?h=n:(s=!0,h=tL(n)),0!==h&&(i-=h*Math.pow(256,e-r-1))}return i},tT=t=>{for(var e=t.length,i=0,s=e-1;s>-1;s--){var r=Number(t[s]);0!==r&&(i+=r*Math.pow(256,e-s-1))}return i},tk=t=>(255^t)&255,tL=t=>(255^t)+1&255,tD=t=>tA.has(t),tx=t=>tI.has(t),tA=new Map([["0","File"],["","OldFile"],["1","Link"],["2","SymbolicLink"],["3","CharacterDevice"],["4","BlockDevice"],["5","Directory"],["6","FIFO"],["7","ContiguousFile"],["g","GlobalExtendedHeader"],["x","ExtendedHeader"],["A","SolarisACL"],["D","GNUDumpDir"],["I","Inode"],["K","NextFileHasLongLinkpath"],["L","NextFileHasLongPath"],["M","ContinuationFile"],["N","OldGnuLongPath"],["S","SparseFile"],["V","TapeVolumeHeader"],["X","OldExtendedHeader"]]),tI=new Map(Array.from(tA).map(t=>[t[1],t[0]]));class tN{cksumValid=!1;needPax=!1;nullBlock=!1;block;path;mode;uid;gid;size;cksum;#d="Unsupported";linkpath;uname;gname;devmaj=0;devmin=0;atime;ctime;mtime;charset;comment;constructor(t,e=0,i,s){Buffer.isBuffer(t)?this.decode(t,e||0,i,s):t&&this.#u(t)}decode(t,e,i,s){if(e||(e=0),!t||!(t.length>=e+512))throw Error("need 512 bytes for header");this.path=i?.path??tB(t,e,100),this.mode=i?.mode??s?.mode??tP(t,e+100,8),this.uid=i?.uid??s?.uid??tP(t,e+108,8),this.gid=i?.gid??s?.gid??tP(t,e+116,8),this.size=i?.size??s?.size??tP(t,e+124,12),this.mtime=i?.mtime??s?.mtime??tC(t,e+136,12),this.cksum=tP(t,e+148,12),s&&this.#u(s,!0),i&&this.#u(i);let r=tB(t,e+156,1);if(tD(r)&&(this.#d=r||"0"),"0"===this.#d&&"/"===this.path.slice(-1)&&(this.#d="5"),"5"===this.#d&&(this.size=0),this.linkpath=tB(t,e+157,100),"ustar\x0000"===t.subarray(e+257,e+265).toString())if(this.uname=i?.uname??s?.uname??tB(t,e+265,32),this.gname=i?.gname??s?.gname??tB(t,e+297,32),this.devmaj=i?.devmaj??s?.devmaj??tP(t,e+329,8)??0,this.devmin=i?.devmin??s?.devmin??tP(t,e+337,8)??0,0!==t[e+475]){let i=tB(t,e+345,155);this.path=i+"/"+this.path}else{let r=tB(t,e+345,130);r&&(this.path=r+"/"+this.path),this.atime=i?.atime??s?.atime??tC(t,e+476,12),this.ctime=i?.ctime??s?.ctime??tC(t,e+488,12)}let h=256;for(let i=e;i<e+148;i++)h+=t[i];for(let i=e+156;i<e+512;i++)h+=t[i];this.cksumValid=h===this.cksum,void 0===this.cksum&&256===h&&(this.nullBlock=!0)}#u(t,e=!1){Object.assign(this,Object.fromEntries(Object.entries(t).filter(([t,i])=>!(null==i||"path"===t&&e||"linkpath"===t&&e||"global"===t))))}encode(t,e=0){if(t||(t=this.block=Buffer.alloc(512)),"Unsupported"===this.#d&&(this.#d="0"),!(t.length>=e+512))throw Error("need 512 bytes for header");let i=this.ctime||this.atime?130:155,s=tF(this.path||"",i),r=s[0],h=s[1];this.needPax=!!s[2],this.needPax=t$(t,e,100,r)||this.needPax,this.needPax=tH(t,e+100,8,this.mode)||this.needPax,this.needPax=tH(t,e+108,8,this.uid)||this.needPax,this.needPax=tH(t,e+116,8,this.gid)||this.needPax,this.needPax=tH(t,e+124,12,this.size)||this.needPax,this.needPax=tV(t,e+136,12,this.mtime)||this.needPax,t[e+156]=this.#d.charCodeAt(0),this.needPax=t$(t,e+157,100,this.linkpath)||this.needPax,t.write("ustar\x0000",e+257,8),this.needPax=t$(t,e+265,32,this.uname)||this.needPax,this.needPax=t$(t,e+297,32,this.gname)||this.needPax,this.needPax=tH(t,e+329,8,this.devmaj)||this.needPax,this.needPax=tH(t,e+337,8,this.devmin)||this.needPax,this.needPax=t$(t,e+345,i,h)||this.needPax,0!==t[e+475]?this.needPax=t$(t,e+345,155,h)||this.needPax:(this.needPax=t$(t,e+345,130,h)||this.needPax,this.needPax=tV(t,e+476,12,this.atime)||this.needPax,this.needPax=tV(t,e+488,12,this.ctime)||this.needPax);let n=256;for(let i=e;i<e+148;i++)n+=t[i];for(let i=e+156;i<e+512;i++)n+=t[i];return this.cksum=n,tH(t,e+148,8,this.cksum),this.cksumValid=!0,this.needPax}get type(){return"Unsupported"===this.#d?this.#d:tA.get(this.#d)}get typeKey(){return this.#d}set type(t){let e=String(tI.get(t));if(tD(e)||"Unsupported"===e)this.#d=e;else if(tD(t))this.#d=t;else throw TypeError("invalid entry type: "+t)}}let tF=(t,e)=>{let i,s=t,r="",h=U.posix.parse(t).root||".";if(100>Buffer.byteLength(s))i=[s,r,!1];else{r=U.posix.dirname(s),s=U.posix.basename(s);do 100>=Buffer.byteLength(s)&&Buffer.byteLength(r)<=e?i=[s,r,!1]:Buffer.byteLength(s)>100&&Buffer.byteLength(r)<=e?i=[s.slice(0,99),r,!0]:(s=U.posix.join(U.posix.basename(r),s),r=U.posix.dirname(r));while(r!==h&&void 0===i);i||(i=[t.slice(0,99),"",!0])}return i},tB=(t,e,i)=>t.subarray(e,e+i).toString("utf8").replace(/\0.*/,""),tC=(t,e,i)=>tM(tP(t,e,i)),tM=t=>void 0===t?void 0:new Date(1e3*t),tP=(t,e,i)=>128&Number(t[e])?tv(t.subarray(e,e+i)):tU(t,e,i),tz=t=>isNaN(t)?void 0:t,tU=(t,e,i)=>tz(parseInt(t.subarray(e,e+i).toString("utf8").replace(/\0.*$/,"").trim(),8)),tj={12:0x1ffffffff,8:2097151},tH=(t,e,i,s)=>void 0!==s&&(s>tj[i]||s<0?(tR(s,t.subarray(e,e+i)),!0):(tZ(t,e,i,s),!1)),tZ=(t,e,i,s)=>t.write(tG(s,i),e,i,"ascii"),tG=(t,e)=>tW(Math.floor(t).toString(8),e),tW=(t,e)=>(t.length===e-1?t:Array(e-t.length-1).join("0")+t+" ")+"\0",tV=(t,e,i,s)=>void 0!==s&&tH(t,e,i,s.getTime()/1e3),tY=Array(156).join("\0"),t$=(t,e,i,s)=>void 0!==s&&(t.write(s+tY,e,i,"utf8"),s.length!==Buffer.byteLength(s)||s.length>i);class tq{atime;mtime;ctime;charset;comment;gid;uid;gname;uname;linkpath;dev;ino;nlink;path;size;mode;global;constructor(t,e=!1){this.atime=t.atime,this.charset=t.charset,this.comment=t.comment,this.ctime=t.ctime,this.dev=t.dev,this.gid=t.gid,this.global=e,this.gname=t.gname,this.ino=t.ino,this.linkpath=t.linkpath,this.mtime=t.mtime,this.nlink=t.nlink,this.path=t.path,this.size=t.size,this.uid=t.uid,this.uname=t.uname}encode(){let t=this.encodeBody();if(""===t)return Buffer.allocUnsafe(0);let e=Buffer.byteLength(t),i=512*Math.ceil(1+e/512),s=Buffer.allocUnsafe(i);for(let t=0;t<512;t++)s[t]=0;new tN({path:("PaxHeader/"+(0,U.basename)(this.path??"")).slice(0,99),mode:this.mode||420,uid:this.uid,gid:this.gid,size:e,mtime:this.mtime,type:this.global?"GlobalExtendedHeader":"ExtendedHeader",linkpath:"",uname:this.uname||"",gname:this.gname||"",devmaj:0,devmin:0,atime:this.atime,ctime:this.ctime}).encode(s),s.write(t,512,e,"utf8");for(let t=e+512;t<s.length;t++)s[t]=0;return s}encodeBody(){return this.encodeField("path")+this.encodeField("ctime")+this.encodeField("atime")+this.encodeField("dev")+this.encodeField("ino")+this.encodeField("nlink")+this.encodeField("charset")+this.encodeField("comment")+this.encodeField("gid")+this.encodeField("gname")+this.encodeField("linkpath")+this.encodeField("mtime")+this.encodeField("size")+this.encodeField("uid")+this.encodeField("uname")}encodeField(t){if(void 0===this[t])return"";let e=this[t],i=" "+("dev"===t||"ino"===t||"nlink"===t?"SCHILY.":"")+t+"="+(e instanceof Date?e.getTime()/1e3:e)+"\n",s=Buffer.byteLength(i),r=Math.floor(Math.log(s)/Math.log(10))+1;return s+r>=Math.pow(10,r)&&(r+=1),r+s+i}static parse(t,e,i=!1){return new tq(tK(tX(t),e),i)}}let tK=(t,e)=>e?Object.assign({},e,t):t,tX=t=>t.replace(/\n$/,"").split("\n").reduce(tQ,Object.create(null)),tQ=(t,e)=>{let i=parseInt(e,10);if(i!==Buffer.byteLength(e)+1)return t;let s=(e=e.slice((i+" ").length)).split("="),r=s.shift();if(!r)return t;let h=r.replace(/^SCHILY\.(dev|ino|nlink)/,"$1"),n=s.join("=");return t[h]=/^([A-Z]+\.)?([mac]|birth|creation)time$/.test(h)?new Date(1e3*Number(n)):/^[0-9]+$/.test(n)?+n:n,t},tJ="win32"!==(process.env.TESTING_TAR_FAKE_PLATFORM||process.platform)?t=>t:t=>t&&t.replace(/\\/g,"/");class t0 extends n.n_{extended;globalExtended;header;startBlockSize;blockRemain;remain;type;meta=!1;ignore=!1;path;mode;uid;gid;uname;gname;size=0;mtime;atime;ctime;linkpath;dev;ino;nlink;invalid=!1;absolute;unsupported=!1;constructor(t,e,i){switch(super({}),this.pause(),this.extended=e,this.globalExtended=i,this.header=t,this.remain=t.size??0,this.startBlockSize=512*Math.ceil(this.remain/512),this.blockRemain=this.startBlockSize,this.type=t.type,this.type){case"File":case"OldFile":case"Link":case"SymbolicLink":case"CharacterDevice":case"BlockDevice":case"Directory":case"FIFO":case"ContiguousFile":case"GNUDumpDir":break;case"NextFileHasLongLinkpath":case"NextFileHasLongPath":case"OldGnuLongPath":case"GlobalExtendedHeader":case"ExtendedHeader":case"OldExtendedHeader":this.meta=!0;break;default:this.ignore=!0}if(!t.path)throw Error("no path provided for tar.ReadEntry");this.path=tJ(t.path),this.mode=t.mode,this.mode&&(this.mode=4095&this.mode),this.uid=t.uid,this.gid=t.gid,this.uname=t.uname,this.gname=t.gname,this.size=this.remain,this.mtime=t.mtime,this.atime=t.atime,this.ctime=t.ctime,this.linkpath=t.linkpath?tJ(t.linkpath):void 0,this.uname=t.uname,this.gname=t.gname,e&&this.#u(e),i&&this.#u(i,!0)}write(t){let e=t.length;if(e>this.blockRemain)throw Error("writing more to entry than is appropriate");let i=this.remain,s=this.blockRemain;return this.remain=Math.max(0,i-e),this.blockRemain=Math.max(0,s-e),!!this.ignore||(i>=e?super.write(t):super.write(t.subarray(0,i)))}#u(t,e=!1){t.path&&(t.path=tJ(t.path)),t.linkpath&&(t.linkpath=tJ(t.linkpath)),Object.assign(this,Object.fromEntries(Object.entries(t).filter(([t,i])=>!(null==i||"path"===t&&e))))}}let t1=(t,e,i,s={})=>{t.file&&(s.file=t.file),t.cwd&&(s.cwd=t.cwd),s.code=i instanceof Error&&i.code||e,s.tarCode=e,t.strict||!1===s.recoverable?i instanceof Error?t.emit("error",Object.assign(i,s)):t.emit("error",Object.assign(Error(`${e}: ${i}`),s)):(i instanceof Error&&(s=Object.assign(i,s),i=i.message),t.emit("warn",e,i,s))},t2=Buffer.from([31,139]),t5=Buffer.from([40,181,47,253]),t3=Math.max(t2.length,t5.length),t4=Symbol("state"),t8=Symbol("writeEntry"),t6=Symbol("readEntry"),t9=Symbol("nextEntry"),t7=Symbol("processEntry"),et=Symbol("extendedHeader"),ee=Symbol("globalExtendedHeader"),ei=Symbol("meta"),es=Symbol("emitMeta"),er=Symbol("buffer"),eh=Symbol("queue"),en=Symbol("ended"),eo=Symbol("emittedEnd"),ea=Symbol("emit"),el=Symbol("unzip"),ed=Symbol("consumeChunk"),eu=Symbol("consumeChunkSub"),ec=Symbol("consumeBody"),em=Symbol("consumeMeta"),ep=Symbol("consumeHeader"),ef=Symbol("consuming"),ey=Symbol("bufferConcat"),eb=Symbol("maybeEnd"),eE=Symbol("writing"),eg=Symbol("aborted"),ew=Symbol("onDone"),eR=Symbol("sawValidEntry"),e_=Symbol("sawNullBlock"),eS=Symbol("sawEOF"),ev=Symbol("closeStream"),eO=()=>!0;class eT extends r.EventEmitter{file;strict;maxMetaEntrySize;filter;brotli;zstd;writable=!0;readable=!1;[eh]=[];[er];[t6];[t8];[t4]="begin";[ei]="";[et];[ee];[en]=!1;[el];[eg]=!1;[eR];[e_]=!1;[eS]=!1;[eE]=!1;[ef]=!1;[eo]=!1;constructor(t={}){super(),this.file=t.file||"",this.on(ew,()=>{("begin"===this[t4]||!1===this[eR])&&this.warn("TAR_BAD_ARCHIVE","Unrecognized archive format")}),t.ondone?this.on(ew,t.ondone):this.on(ew,()=>{this.emit("prefinish"),this.emit("finish"),this.emit("end")}),this.strict=!!t.strict,this.maxMetaEntrySize=t.maxMetaEntrySize||1048576,this.filter="function"==typeof t.filter?t.filter:eO;let e=t.file&&(t.file.endsWith(".tar.br")||t.file.endsWith(".tbr"));this.brotli=t.gzip||t.zstd||void 0===t.brotli?!!e&&void 0:t.brotli;let i=t.file&&(t.file.endsWith(".tar.zst")||t.file.endsWith(".tzst"));this.zstd=t.gzip||t.brotli||void 0===t.zstd?!!i||void 0:t.zstd,this.on("end",()=>this[ev]()),"function"==typeof t.onwarn&&this.on("warn",t.onwarn),"function"==typeof t.onReadEntry&&this.on("entry",t.onReadEntry)}warn(t,e,i={}){t1(this,t,e,i)}[ep](t,e){let i;void 0===this[eR]&&(this[eR]=!1);try{i=new tN(t,e,this[et],this[ee])}catch(t){return this.warn("TAR_ENTRY_INVALID",t)}if(i.nullBlock)this[e_]?(this[eS]=!0,"begin"===this[t4]&&(this[t4]="header"),this[ea]("eof")):(this[e_]=!0,this[ea]("nullBlock"));else if(this[e_]=!1,i.cksumValid)if(i.path){let t=i.type;if(/^(Symbolic)?Link$/.test(t)&&!i.linkpath)this.warn("TAR_ENTRY_INVALID","linkpath required",{header:i});else if(/^(Symbolic)?Link$/.test(t)||/^(Global)?ExtendedHeader$/.test(t)||!i.linkpath){let t=this[t8]=new t0(i,this[et],this[ee]);this[eR]||(t.remain?t.on("end",()=>{t.invalid||(this[eR]=!0)}):this[eR]=!0),t.meta?t.size>this.maxMetaEntrySize?(t.ignore=!0,this[ea]("ignoredEntry",t),this[t4]="ignore",t.resume()):t.size>0&&(this[ei]="",t.on("data",t=>this[ei]+=t),this[t4]="meta"):(this[et]=void 0,t.ignore=t.ignore||!this.filter(t.path,t),t.ignore?(this[ea]("ignoredEntry",t),this[t4]=t.remain?"ignore":"header",t.resume()):(t.remain?this[t4]="body":(this[t4]="header",t.end()),this[t6]?this[eh].push(t):(this[eh].push(t),this[t9]())))}else this.warn("TAR_ENTRY_INVALID","linkpath forbidden",{header:i})}else this.warn("TAR_ENTRY_INVALID","path is required",{header:i});else this.warn("TAR_ENTRY_INVALID","checksum failure",{header:i})}[ev](){queueMicrotask(()=>this.emit("close"))}[t7](t){let e=!0;if(t)if(Array.isArray(t)){let[e,...i]=t;this.emit(e,...i)}else this[t6]=t,this.emit("entry",t),t.emittedEnd||(t.on("end",()=>this[t9]()),e=!1);else this[t6]=void 0,e=!1;return e}[t9](){do;while(this[t7](this[eh].shift()));if(!this[eh].length){let t=this[t6];!t||t.flowing||t.size===t.remain?this[eE]||this.emit("drain"):t.once("drain",()=>this.emit("drain"))}}[ec](t,e){let i=this[t8];if(!i)throw Error("attempt to consume body without entry??");let s=i.blockRemain??0,r=s>=t.length&&0===e?t:t.subarray(e,e+s);return i.write(r),i.blockRemain||(this[t4]="header",this[t8]=void 0,i.end()),r.length}[em](t,e){let i=this[t8],s=this[ec](t,e);return!this[t8]&&i&&this[es](i),s}[ea](t,e,i){this[eh].length||this[t6]?this[eh].push([t,e,i]):this.emit(t,e,i)}[es](t){switch(this[ea]("meta",this[ei]),t.type){case"ExtendedHeader":case"OldExtendedHeader":this[et]=tq.parse(this[ei],this[et],!1);break;case"GlobalExtendedHeader":this[ee]=tq.parse(this[ei],this[ee],!0);break;case"NextFileHasLongPath":case"OldGnuLongPath":{let t=this[et]??Object.create(null);this[et]=t,t.path=this[ei].replace(/\0.*/,"");break}case"NextFileHasLongLinkpath":{let t=this[et]||Object.create(null);this[et]=t,t.linkpath=this[ei].replace(/\0.*/,"");break}default:throw Error("unknown meta: "+t.type)}}abort(t){this[eg]=!0,this.emit("abort",t),this.warn("TAR_ABORT",t,{recoverable:!1})}write(t,e,i){if("function"==typeof e&&(i=e,e=void 0),"string"==typeof t&&(t=Buffer.from(t,"string"==typeof e?e:"utf8")),this[eg])return i?.(),!1;if((void 0===this[el]||void 0===this.brotli&&!1===this[el])&&t){if(this[er]&&(t=Buffer.concat([this[er],t]),this[er]=void 0),t.length<t3)return this[er]=t,i?.(),!0;for(let e=0;void 0===this[el]&&e<t2.length;e++)t[e]!==t2[e]&&(this[el]=!1);let e=!1;if(!1===this[el]&&!1!==this.zstd){e=!0;for(let i=0;i<t5.length;i++)if(t[i]!==t5[i]){e=!1;break}}let s=void 0===this.brotli&&!e;if(!1===this[el]&&s)if(t.length<512)if(!this[en])return this[er]=t,i?.(),!0;else this.brotli=!0;else try{new tN(t.subarray(0,512)),this.brotli=!1}catch(t){this.brotli=!0}if(void 0===this[el]||!1===this[el]&&(this.brotli||e)){let s=this[en];this[en]=!1,this[el]=void 0===this[el]?new tp({}):e?new tw({}):new tb({}),this[el].on("data",t=>this[ed](t)),this[el].on("error",t=>this.abort(t)),this[el].on("end",()=>{this[en]=!0,this[ed]()}),this[eE]=!0;let r=!!this[el][s?"end":"write"](t);return this[eE]=!1,i?.(),r}}this[eE]=!0,this[el]?this[el].write(t):this[ed](t),this[eE]=!1;let s=!this[eh].length&&(!this[t6]||this[t6].flowing);return s||this[eh].length||this[t6]?.once("drain",()=>this.emit("drain")),i?.(),s}[ey](t){t&&!this[eg]&&(this[er]=this[er]?Buffer.concat([this[er],t]):t)}[eb](){if(this[en]&&!this[eo]&&!this[eg]&&!this[ef]){this[eo]=!0;let t=this[t8];if(t&&t.blockRemain){let e=this[er]?this[er].length:0;this.warn("TAR_BAD_ARCHIVE",`Truncated input (needed ${t.blockRemain} more bytes, only ${e} available)`,{entry:t}),this[er]&&t.write(this[er]),t.end()}this[ea](ew)}}[ed](t){if(this[ef]&&t)this[ey](t);else if(t||this[er]){if(t){if(this[ef]=!0,this[er]){this[ey](t);let e=this[er];this[er]=void 0,this[eu](e)}else this[eu](t);for(;this[er]&&this[er]?.length>=512&&!this[eg]&&!this[eS];){let t=this[er];this[er]=void 0,this[eu](t)}this[ef]=!1}}else this[eb]();(!this[er]||this[en])&&this[eb]()}[eu](t){let e=0,i=t.length;for(;e+512<=i&&!this[eg]&&!this[eS];)switch(this[t4]){case"begin":case"header":this[ep](t,e),e+=512;break;case"ignore":case"body":e+=this[ec](t,e);break;case"meta":e+=this[em](t,e);break;default:throw Error("invalid state: "+this[t4])}e<i&&(this[er]?this[er]=Buffer.concat([t.subarray(e),this[er]]):this[er]=t.subarray(e))}end(t,e,i){return"function"==typeof t&&(i=t,e=void 0,t=void 0),"function"==typeof e&&(i=e,e=void 0),"string"==typeof t&&(t=Buffer.from(t,e)),i&&this.once("finish",i),this[eg]||(this[el]?(t&&this[el].write(t),this[el].end()):(this[en]=!0,(void 0===this.brotli||void 0===this.zstd)&&(t=t||Buffer.alloc(0)),t&&this.write(t),this[eb]())),this}}let ek=t=>{let e=t.length-1,i=-1;for(;e>-1&&"/"===t.charAt(e);)i=e,e--;return -1===i?t:t.slice(0,i)},eL=t=>{let e=t.onReadEntry;t.onReadEntry=e?t=>{e(t),t.resume()}:t=>t.resume()},eD=(t,e)=>{let i=new Map(e.map(t=>[ek(t),!0])),s=t.filter,r=(t,e="")=>{let s,h=e||(0,H.parse)(t).root||".";if(t===h)s=!1;else{let e=i.get(t);s=void 0!==e?e:r((0,H.dirname)(t),h)}return i.set(t,s),s};t.filter=s?(t,e)=>s(t,e)&&r(ek(t)):t=>r(ek(t))},ex=X(t=>{let e,i=new eT(t),s=t.file;try{e=j.openSync(s,"r");let r=j.fstatSync(e),h=t.maxReadSize||0x1000000;if(r.size<h){let t=Buffer.allocUnsafe(r.size),s=j.readSync(e,t,0,r.size,0);i.end(s===t.byteLength?t:t.subarray(0,s))}else{let t=0,s=Buffer.allocUnsafe(h);for(;t<r.size;){let r=j.readSync(e,s,0,h,t);if(0===r)break;t+=r,i.write(s.subarray(0,r))}i.end()}}finally{if("number"==typeof e)try{j.closeSync(e)}catch(t){}}},(t,e)=>{let i=new eT(t),s=t.maxReadSize||0x1000000,r=t.file;return new Promise((t,e)=>{i.on("error",e),i.on("end",t),j.stat(r,(t,h)=>{if(t)e(t);else{let t=new C(r,{readSize:s,size:h.size});t.on("error",e),t.pipe(i)}})})},t=>new eT(t),t=>new eT(t),(t,e)=>{e?.length&&eD(t,e),t.noResume||eL(t)}),eA=(t,e,i)=>(t&=4095,i&&(t=(384|t)&-19),e&&(256&t&&(t|=64),32&t&&(t|=8),4&t&&(t|=1)),t),{isAbsolute:eI,parse:eN}=U.win32,eF=t=>{let e="",i=eN(t);for(;eI(t)||i.root;){let s="/"===t.charAt(0)&&"//?/"!==t.slice(0,4)?"/":i.root;t=t.slice(s.length),e+=s,i=eN(t)}return[e,t]},eB=["|","<",">","?",":"],eC=eB.map(t=>String.fromCharCode(61440+t.charCodeAt(0))),eM=new Map(eB.map((t,e)=>[t,eC[e]])),eP=new Map(eC.map((t,e)=>[t,eB[e]])),ez=t=>eB.reduce((t,e)=>t.split(e).join(eM.get(e)),t),eU=t=>eC.reduce((t,e)=>t.split(e).join(eP.get(e)),t),ej=(t,e)=>e?(t=tJ(t).replace(/^\.(\/|$)/,""),ek(e)+"/"+t):tJ(t),eH=Symbol("process"),eZ=Symbol("file"),eG=Symbol("directory"),eW=Symbol("symlink"),eV=Symbol("hardlink"),eY=Symbol("header"),e$=Symbol("read"),eq=Symbol("lstat"),eK=Symbol("onlstat"),eX=Symbol("onread"),eQ=Symbol("onreadlink"),eJ=Symbol("openfile"),e0=Symbol("onopenfile"),e1=Symbol("close"),e2=Symbol("mode"),e5=Symbol("awaitDrain"),e3=Symbol("ondrain"),e4=Symbol("prefix");class e8 extends n.n_{path;portable;myuid=process.getuid&&process.getuid()||0;myuser=process.env.USER||"";maxReadSize;linkCache;statCache;preservePaths;cwd;strict;mtime;noPax;noMtime;prefix;fd;blockLen=0;blockRemain=0;buf;pos=0;remain=0;length=0;offset=0;win32;absolute;header;type;linkpath;stat;onWriteEntry;#c=!1;constructor(t,e={}){let i=K(e);super(),this.path=tJ(t),this.portable=!!i.portable,this.maxReadSize=i.maxReadSize||0x1000000,this.linkCache=i.linkCache||new Map,this.statCache=i.statCache||new Map,this.preservePaths=!!i.preservePaths,this.cwd=tJ(i.cwd||process.cwd()),this.strict=!!i.strict,this.noPax=!!i.noPax,this.noMtime=!!i.noMtime,this.mtime=i.mtime,this.prefix=i.prefix?tJ(i.prefix):void 0,this.onWriteEntry=i.onWriteEntry,"function"==typeof i.onwarn&&this.on("warn",i.onwarn);let s=!1;if(!this.preservePaths){let[t,e]=eF(this.path);t&&"string"==typeof e&&(this.path=e,s=t)}this.win32=!!i.win32||"win32"===process.platform,this.win32&&(this.path=eU(this.path.replace(/\\/g,"/")),t=t.replace(/\\/g,"/")),this.absolute=tJ(i.absolute||H.resolve(this.cwd,t)),""===this.path&&(this.path="./"),s&&this.warn("TAR_ENTRY_INFO",`stripping ${s} from absolute path`,{entry:this,path:s+this.path});let r=this.statCache.get(this.absolute);r?this[eK](r):this[eq]()}warn(t,e,i={}){return t1(this,t,e,i)}emit(t,...e){return"error"===t&&(this.#c=!0),super.emit(t,...e)}[eq](){h.lstat(this.absolute,(t,e)=>{if(t)return this.emit("error",t);this[eK](e)})}[eK](t){this.statCache.set(this.absolute,t),this.stat=t,t.isFile()||(t.size=0),this.type=e7(t),this.emit("stat",t),this[eH]()}[eH](){switch(this.type){case"File":return this[eZ]();case"Directory":return this[eG]();case"SymbolicLink":return this[eW]();default:return this.end()}}[e2](t){return eA(t,"Directory"===this.type,this.portable)}[e4](t){return ej(t,this.prefix)}[eY](){if(!this.stat)throw Error("cannot write header before stat");"Directory"===this.type&&this.portable&&(this.noMtime=!0),this.onWriteEntry?.(this),this.header=new tN({path:this[e4](this.path),linkpath:"Link"===this.type&&void 0!==this.linkpath?this[e4](this.linkpath):this.linkpath,mode:this[e2](this.stat.mode),uid:this.portable?void 0:this.stat.uid,gid:this.portable?void 0:this.stat.gid,size:this.stat.size,mtime:this.noMtime?void 0:this.mtime||this.stat.mtime,type:"Unsupported"===this.type?void 0:this.type,uname:this.portable?void 0:this.stat.uid===this.myuid?this.myuser:"",atime:this.portable?void 0:this.stat.atime,ctime:this.portable?void 0:this.stat.ctime}),this.header.encode()&&!this.noPax&&super.write(new tq({atime:this.portable?void 0:this.header.atime,ctime:this.portable?void 0:this.header.ctime,gid:this.portable?void 0:this.header.gid,mtime:this.noMtime?void 0:this.mtime||this.header.mtime,path:this[e4](this.path),linkpath:"Link"===this.type&&void 0!==this.linkpath?this[e4](this.linkpath):this.linkpath,size:this.header.size,uid:this.portable?void 0:this.header.uid,uname:this.portable?void 0:this.header.uname,dev:this.portable?void 0:this.stat.dev,ino:this.portable?void 0:this.stat.ino,nlink:this.portable?void 0:this.stat.nlink}).encode());let t=this.header?.block;if(!t)throw Error("failed to encode header");super.write(t)}[eG](){if(!this.stat)throw Error("cannot create directory entry without stat");"/"!==this.path.slice(-1)&&(this.path+="/"),this.stat.size=0,this[eY](),this.end()}[eW](){h.readlink(this.absolute,(t,e)=>{if(t)return this.emit("error",t);this[eQ](e)})}[eQ](t){this.linkpath=tJ(t),this[eY](),this.end()}[eV](t){if(!this.stat)throw Error("cannot create link entry without stat");this.type="Link",this.linkpath=tJ(H.relative(this.cwd,t)),this.stat.size=0,this[eY](),this.end()}[eZ](){if(!this.stat)throw Error("cannot create file entry without stat");if(this.stat.nlink>1){let t=`${this.stat.dev}:${this.stat.ino}`,e=this.linkCache.get(t);if(e?.indexOf(this.cwd)===0)return this[eV](e);this.linkCache.set(t,this.absolute)}if(this[eY](),0===this.stat.size)return this.end();this[eJ]()}[eJ](){h.open(this.absolute,"r",(t,e)=>{if(t)return this.emit("error",t);this[e0](e)})}[e0](t){if(this.fd=t,this.#c)return this[e1]();if(!this.stat)throw Error("should stat before calling onopenfile");this.blockLen=512*Math.ceil(this.stat.size/512),this.blockRemain=this.blockLen;let e=Math.min(this.blockLen,this.maxReadSize);this.buf=Buffer.allocUnsafe(e),this.offset=0,this.pos=0,this.remain=this.stat.size,this.length=this.buf.length,this[e$]()}[e$](){let{fd:t,buf:e,offset:i,length:s,pos:r}=this;if(void 0===t||void 0===e)throw Error("cannot read file without first opening");h.read(t,e,i,s,r,(t,e)=>{if(t)return this[e1](()=>this.emit("error",t));this[eX](e)})}[e1](t=()=>{}){void 0!==this.fd&&h.close(this.fd,t)}[eX](t){if(t<=0&&this.remain>0){let t=Object.assign(Error("encountered unexpected EOF"),{path:this.absolute,syscall:"read",code:"EOF"});return this[e1](()=>this.emit("error",t))}if(t>this.remain){let t=Object.assign(Error("did not encounter expected EOF"),{path:this.absolute,syscall:"read",code:"EOF"});return this[e1](()=>this.emit("error",t))}if(!this.buf)throw Error("should have created buffer prior to reading");if(t===this.remain)for(let e=t;e<this.length&&t<this.blockRemain;e++)this.buf[e+this.offset]=0,t++,this.remain++;let e=0===this.offset&&t===this.buf.length?this.buf:this.buf.subarray(this.offset,this.offset+t);this.write(e)?this[e3]():this[e5](()=>this[e3]())}[e5](t){this.once("drain",t)}write(t,e,i){if("function"==typeof e&&(i=e,e=void 0),"string"==typeof t&&(t=Buffer.from(t,"string"==typeof e?e:"utf8")),this.blockRemain<t.length){let t=Object.assign(Error("writing more data than expected"),{path:this.absolute});return this.emit("error",t)}return this.remain-=t.length,this.blockRemain-=t.length,this.pos+=t.length,this.offset+=t.length,super.write(t,null,i)}[e3](){if(!this.remain)return this.blockRemain&&super.write(Buffer.alloc(this.blockRemain)),this[e1](t=>t?this.emit("error",t):this.end());if(!this.buf)throw Error("buffer lost somehow in ONDRAIN");this.offset>=this.length&&(this.buf=Buffer.allocUnsafe(Math.min(this.blockRemain,this.buf.length)),this.offset=0),this.length=this.buf.length-this.offset,this[e$]()}}class e6 extends e8{sync=!0;[eq](){this[eK](h.lstatSync(this.absolute))}[eW](){this[eQ](h.readlinkSync(this.absolute))}[eJ](){this[e0](h.openSync(this.absolute,"r"))}[e$](){let t=!0;try{let{fd:e,buf:i,offset:s,length:r,pos:n}=this;if(void 0===e||void 0===i)throw Error("fd and buf must be set in READ method");let o=h.readSync(e,i,s,r,n);this[eX](o),t=!1}finally{if(t)try{this[e1](()=>{})}catch(t){}}}[e5](t){t()}[e1](t=()=>{}){void 0!==this.fd&&h.closeSync(this.fd),t()}}class e9 extends n.n_{blockLen=0;blockRemain=0;buf=0;pos=0;remain=0;length=0;preservePaths;portable;strict;noPax;noMtime;readEntry;type;prefix;path;mode;uid;gid;uname;gname;header;mtime;atime;ctime;linkpath;size;onWriteEntry;warn(t,e,i={}){return t1(this,t,e,i)}constructor(t,e={}){let i=K(e);super(),this.preservePaths=!!i.preservePaths,this.portable=!!i.portable,this.strict=!!i.strict,this.noPax=!!i.noPax,this.noMtime=!!i.noMtime,this.onWriteEntry=i.onWriteEntry,this.readEntry=t;let{type:s}=t;if("Unsupported"===s)throw Error("writing entry that should be ignored");this.type=s,"Directory"===this.type&&this.portable&&(this.noMtime=!0),this.prefix=i.prefix,this.path=tJ(t.path),this.mode=void 0!==t.mode?this[e2](t.mode):void 0,this.uid=this.portable?void 0:t.uid,this.gid=this.portable?void 0:t.gid,this.uname=this.portable?void 0:t.uname,this.gname=this.portable?void 0:t.gname,this.size=t.size,this.mtime=this.noMtime?void 0:i.mtime||t.mtime,this.atime=this.portable?void 0:t.atime,this.ctime=this.portable?void 0:t.ctime,this.linkpath=void 0!==t.linkpath?tJ(t.linkpath):void 0,"function"==typeof i.onwarn&&this.on("warn",i.onwarn);let r=!1;if(!this.preservePaths){let[t,e]=eF(this.path);t&&"string"==typeof e&&(this.path=e,r=t)}this.remain=t.size,this.blockRemain=t.startBlockSize,this.onWriteEntry?.(this),this.header=new tN({path:this[e4](this.path),linkpath:"Link"===this.type&&void 0!==this.linkpath?this[e4](this.linkpath):this.linkpath,mode:this.mode,uid:this.portable?void 0:this.uid,gid:this.portable?void 0:this.gid,size:this.size,mtime:this.noMtime?void 0:this.mtime,type:this.type,uname:this.portable?void 0:this.uname,atime:this.portable?void 0:this.atime,ctime:this.portable?void 0:this.ctime}),r&&this.warn("TAR_ENTRY_INFO",`stripping ${r} from absolute path`,{entry:this,path:r+this.path}),this.header.encode()&&!this.noPax&&super.write(new tq({atime:this.portable?void 0:this.atime,ctime:this.portable?void 0:this.ctime,gid:this.portable?void 0:this.gid,mtime:this.noMtime?void 0:this.mtime,path:this[e4](this.path),linkpath:"Link"===this.type&&void 0!==this.linkpath?this[e4](this.linkpath):this.linkpath,size:this.size,uid:this.portable?void 0:this.uid,uname:this.portable?void 0:this.uname,dev:this.portable?void 0:this.readEntry.dev,ino:this.portable?void 0:this.readEntry.ino,nlink:this.portable?void 0:this.readEntry.nlink}).encode());let h=this.header?.block;if(!h)throw Error("failed to encode header");super.write(h),t.pipe(this)}[e4](t){return ej(t,this.prefix)}[e2](t){return eA(t,"Directory"===this.type,this.portable)}write(t,e,i){"function"==typeof e&&(i=e,e=void 0),"string"==typeof t&&(t=Buffer.from(t,"string"==typeof e?e:"utf8"));let s=t.length;if(s>this.blockRemain)throw Error("writing more to entry than is appropriate");return this.blockRemain-=s,super.write(t,i)}end(t,e,i){return this.blockRemain&&super.write(Buffer.alloc(this.blockRemain)),"function"==typeof t&&(i=t,e=void 0,t=void 0),"function"==typeof e&&(i=e,e=void 0),"string"==typeof t&&(t=Buffer.from(t,e??"utf8")),i&&this.once("finish",i),t?super.end(t,i):super.end(i),this}}let e7=t=>t.isFile()?"File":t.isDirectory()?"Directory":t.isSymbolicLink()?"SymbolicLink":"Unsupported";class it{tail;head;length=0;static create(t=[]){return new it(t)}constructor(t=[]){for(let e of t)this.push(e)}*[Symbol.iterator](){for(let t=this.head;t;t=t.next)yield t.value}removeNode(t){if(t.list!==this)throw Error("removing node which does not belong to this list");let e=t.next,i=t.prev;return e&&(e.prev=i),i&&(i.next=e),t===this.head&&(this.head=e),t===this.tail&&(this.tail=i),this.length--,t.next=void 0,t.prev=void 0,t.list=void 0,e}unshiftNode(t){if(t===this.head)return;t.list&&t.list.removeNode(t);let e=this.head;t.list=this,t.next=e,e&&(e.prev=t),this.head=t,this.tail||(this.tail=t),this.length++}pushNode(t){if(t===this.tail)return;t.list&&t.list.removeNode(t);let e=this.tail;t.list=this,t.prev=e,e&&(e.next=t),this.tail=t,this.head||(this.head=t),this.length++}push(...t){for(let i=0,s=t.length;i<s;i++){var e;e=this,e.tail=new ie(t[i],e.tail,void 0,e),e.head||(e.head=e.tail),e.length++}return this.length}unshift(...t){for(var e,i=0,s=t.length;i<s;i++){e=this,e.head=new ie(t[i],void 0,e.head,e),e.tail||(e.tail=e.head),e.length++}return this.length}pop(){if(!this.tail)return;let t=this.tail.value,e=this.tail;return this.tail=this.tail.prev,this.tail?this.tail.next=void 0:this.head=void 0,e.list=void 0,this.length--,t}shift(){if(!this.head)return;let t=this.head.value,e=this.head;return this.head=this.head.next,this.head?this.head.prev=void 0:this.tail=void 0,e.list=void 0,this.length--,t}forEach(t,e){e=e||this;for(let i=this.head,s=0;i;s++)t.call(e,i.value,s,this),i=i.next}forEachReverse(t,e){e=e||this;for(let i=this.tail,s=this.length-1;i;s--)t.call(e,i.value,s,this),i=i.prev}get(t){let e=0,i=this.head;for(;i&&e<t;e++)i=i.next;if(e===t&&i)return i.value}getReverse(t){let e=0,i=this.tail;for(;i&&e<t;e++)i=i.prev;if(e===t&&i)return i.value}map(t,e){e=e||this;let i=new it;for(let s=this.head;s;)i.push(t.call(e,s.value,this)),s=s.next;return i}mapReverse(t,e){e=e||this;var i=new it;for(let s=this.tail;s;)i.push(t.call(e,s.value,this)),s=s.prev;return i}reduce(t,e){let i,s=this.head;if(arguments.length>1)i=e;else if(this.head)s=this.head.next,i=this.head.value;else throw TypeError("Reduce of empty list with no initial value");for(var r=0;s;r++)i=t(i,s.value,r),s=s.next;return i}reduceReverse(t,e){let i,s=this.tail;if(arguments.length>1)i=e;else if(this.tail)s=this.tail.prev,i=this.tail.value;else throw TypeError("Reduce of empty list with no initial value");for(let e=this.length-1;s;e--)i=t(i,s.value,e),s=s.prev;return i}toArray(){let t=Array(this.length);for(let e=0,i=this.head;i;e++)t[e]=i.value,i=i.next;return t}toArrayReverse(){let t=Array(this.length);for(let e=0,i=this.tail;i;e++)t[e]=i.value,i=i.prev;return t}slice(t=0,e=this.length){e<0&&(e+=this.length),t<0&&(t+=this.length);let i=new it;if(e<t||e<0)return i;t<0&&(t=0),e>this.length&&(e=this.length);let s=this.head,r=0;for(r=0;s&&r<t;r++)s=s.next;for(;s&&r<e;r++,s=s.next)i.push(s.value);return i}sliceReverse(t=0,e=this.length){e<0&&(e+=this.length),t<0&&(t+=this.length);let i=new it;if(e<t||e<0)return i;t<0&&(t=0),e>this.length&&(e=this.length);let s=this.length,r=this.tail;for(;r&&s>e;s--)r=r.prev;for(;r&&s>t;s--,r=r.prev)i.push(r.value);return i}splice(t,e=0,...i){t>this.length&&(t=this.length-1),t<0&&(t=this.length+t);let s=this.head;for(let e=0;s&&e<t;e++)s=s.next;let r=[];for(let t=0;s&&t<e;t++)r.push(s.value),s=this.removeNode(s);for(let t of(s?s!==this.tail&&(s=s.prev):s=this.tail,i))s=function(t,e,i){let s=e?e.next:t.head,r=new ie(i,e,s,t);return void 0===r.next&&(t.tail=r),void 0===r.prev&&(t.head=r),t.length++,r}(this,s,t);return r}reverse(){let t=this.head,e=this.tail;for(let e=t;e;e=e.prev){let t=e.prev;e.prev=e.next,e.next=t}return this.head=e,this.tail=t,this}}class ie{list;next;prev;value;constructor(t,e,i,s){this.list=s,this.value=t,e?(e.next=this,this.prev=e):this.prev=void 0,i?(i.prev=this,this.next=i):this.next=void 0}}class ii{path;absolute;entry;stat;readdir;pending=!1;ignore=!1;piped=!1;constructor(t,e){this.path=t||"./",this.absolute=e}}let is=Buffer.alloc(1024),ir=Symbol("onStat"),ih=Symbol("ended"),io=Symbol("queue"),ia=Symbol("current"),il=Symbol("process"),id=Symbol("processing"),iu=Symbol("processJob"),ic=Symbol("jobs"),im=Symbol("jobDone"),ip=Symbol("addFSEntry"),iy=Symbol("addTarEntry"),ib=Symbol("stat"),iE=Symbol("readdir"),ig=Symbol("onreaddir"),iw=Symbol("pipe"),iR=Symbol("entry"),i_=Symbol("entryOpt"),iS=Symbol("writeEntryClass"),iv=Symbol("write"),iO=Symbol("ondrain");class iT extends n.n_{opt;cwd;maxReadSize;preservePaths;strict;noPax;prefix;linkCache;statCache;file;portable;zip;readdirCache;noDirRecurse;follow;noMtime;mtime;filter;jobs;[iS];onWriteEntry;[io];[ic]=0;[id]=!1;[ih]=!1;constructor(t={}){if(super(),this.opt=t,this.file=t.file||"",this.cwd=t.cwd||process.cwd(),this.maxReadSize=t.maxReadSize,this.preservePaths=!!t.preservePaths,this.strict=!!t.strict,this.noPax=!!t.noPax,this.prefix=tJ(t.prefix||""),this.linkCache=t.linkCache||new Map,this.statCache=t.statCache||new Map,this.readdirCache=t.readdirCache||new Map,this.onWriteEntry=t.onWriteEntry,this[iS]=e8,"function"==typeof t.onwarn&&this.on("warn",t.onwarn),this.portable=!!t.portable,t.gzip||t.brotli||t.zstd){if(+!!t.gzip+ +!!t.brotli+ +!!t.zstd>1)throw TypeError("gzip, brotli, zstd are mutually exclusive");if(t.gzip&&("object"!=typeof t.gzip&&(t.gzip={}),this.portable&&(t.gzip.portable=!0),this.zip=new tm(t.gzip)),t.brotli&&("object"!=typeof t.brotli&&(t.brotli={}),this.zip=new ty(t.brotli)),t.zstd&&("object"!=typeof t.zstd&&(t.zstd={}),this.zip=new tg(t.zstd)),!this.zip)throw Error("impossible");let e=this.zip;e.on("data",t=>super.write(t)),e.on("end",()=>super.end()),e.on("drain",()=>this[iO]()),this.on("resume",()=>e.resume())}else this.on("drain",this[iO]);this.noDirRecurse=!!t.noDirRecurse,this.follow=!!t.follow,this.noMtime=!!t.noMtime,t.mtime&&(this.mtime=t.mtime),this.filter="function"==typeof t.filter?t.filter:()=>!0,this[io]=new it,this[ic]=0,this.jobs=Number(t.jobs)||4,this[id]=!1,this[ih]=!1}[iv](t){return super.write(t)}add(t){return this.write(t),this}end(t,e,i){return"function"==typeof t&&(i=t,t=void 0),"function"==typeof e&&(i=e,e=void 0),t&&this.add(t),this[ih]=!0,this[il](),i&&i(),this}write(t){if(this[ih])throw Error("write after end");return t instanceof t0?this[iy](t):this[ip](t),this.flowing}[iy](t){let e=tJ(H.resolve(this.cwd,t.path));if(this.filter(t.path,t)){let i=new ii(t.path,e);i.entry=new e9(t,this[i_](i)),i.entry.on("end",()=>this[im](i)),this[ic]+=1,this[io].push(i)}else t.resume();this[il]()}[ip](t){let e=tJ(H.resolve(this.cwd,t));this[io].push(new ii(t,e)),this[il]()}[ib](t){t.pending=!0,this[ic]+=1,h[this.follow?"stat":"lstat"](t.absolute,(e,i)=>{t.pending=!1,this[ic]-=1,e?this.emit("error",e):this[ir](t,i)})}[ir](t,e){this.statCache.set(t.absolute,e),t.stat=e,this.filter(t.path,e)||(t.ignore=!0),this[il]()}[iE](t){t.pending=!0,this[ic]+=1,h.readdir(t.absolute,(e,i)=>{if(t.pending=!1,this[ic]-=1,e)return this.emit("error",e);this[ig](t,i)})}[ig](t,e){this.readdirCache.set(t.absolute,e),t.readdir=e,this[il]()}[il](){if(!this[id]){this[id]=!0;for(let t=this[io].head;t&&this[ic]<this.jobs;t=t.next)if(this[iu](t.value),t.value.ignore){let e=t.next;this[io].removeNode(t),t.next=e}this[id]=!1,this[ih]&&!this[io].length&&0===this[ic]&&(this.zip?this.zip.end(is):(super.write(is),super.end()))}}get[ia](){return this[io]&&this[io].head&&this[io].head.value}[im](t){this[io].shift(),this[ic]-=1,this[il]()}[iu](t){if(!t.pending){if(t.entry){t!==this[ia]||t.piped||this[iw](t);return}if(!t.stat){let e=this.statCache.get(t.absolute);e?this[ir](t,e):this[ib](t)}if(t.stat&&!t.ignore){if(!this.noDirRecurse&&t.stat.isDirectory()&&!t.readdir){let e=this.readdirCache.get(t.absolute);if(e?this[ig](t,e):this[iE](t),!t.readdir)return}if(t.entry=this[iR](t),!t.entry){t.ignore=!0;return}t!==this[ia]||t.piped||this[iw](t)}}}[i_](t){return{onwarn:(t,e,i)=>this.warn(t,e,i),noPax:this.noPax,cwd:this.cwd,absolute:t.absolute,preservePaths:this.preservePaths,maxReadSize:this.maxReadSize,strict:this.strict,portable:this.portable,linkCache:this.linkCache,statCache:this.statCache,noMtime:this.noMtime,mtime:this.mtime,prefix:this.prefix,onWriteEntry:this.onWriteEntry}}[iR](t){this[ic]+=1;try{return new this[iS](t.path,this[i_](t)).on("end",()=>this[im](t)).on("error",t=>this.emit("error",t))}catch(t){this.emit("error",t)}}[iO](){this[ia]&&this[ia].entry&&this[ia].entry.resume()}[iw](t){t.piped=!0,t.readdir&&t.readdir.forEach(e=>{let i=t.path,s="./"===i?"":i.replace(/\/*$/,"/");this[ip](s+e)});let e=t.entry,i=this.zip;if(!e)throw Error("cannot pipe without source");i?e.on("data",t=>{i.write(t)||e.pause()}):e.on("data",t=>{super.write(t)||e.pause()})}pause(){return this.zip&&this.zip.pause(),super.pause()}warn(t,e,i={}){t1(this,t,e,i)}}class ik extends iT{sync=!0;constructor(t){super(t),this[iS]=e6}pause(){}resume(){}[ib](t){let e=this.follow?"statSync":"lstatSync";this[ir](t,h[e](t.absolute))}[iE](t){this[ig](t,h.readdirSync(t.absolute))}[iw](t){let e=t.entry,i=this.zip;if(t.readdir&&t.readdir.forEach(e=>{let i=t.path,s="./"===i?"":i.replace(/\/*$/,"/");this[ip](s+e)}),!e)throw Error("Cannot pipe without source");i?e.on("data",t=>{i.write(t)}):e.on("data",t=>{super[iv](t)})}}let iL=(t,e)=>{e.forEach(e=>{"@"===e.charAt(0)?ex({file:U.resolve(t.cwd,e.slice(1)),sync:!0,noResume:!0,onReadEntry:e=>t.add(e)}):t.add(e)}),t.end()},iD=async(t,e)=>{for(let i=0;i<e.length;i++){let s=String(e[i]);"@"===s.charAt(0)?await ex({file:U.resolve(String(t.cwd),s.slice(1)),noResume:!0,onReadEntry:e=>{t.add(e)}}):t.add(s)}t.end()},ix=X((t,e)=>{let i=new ik(t),s=new z(t.file,{mode:t.mode||438});i.pipe(s),iL(i,e)},(t,e)=>{let i=new iT(t),s=new P(t.file,{mode:t.mode||438});i.pipe(s);let r=new Promise((t,e)=>{s.on("error",e),s.on("close",t),i.on("error",e)});return iD(i,e),r},(t,e)=>{let i=new ik(t);return iL(i,e),i},(t,e)=>{let i=new iT(t);return iD(i,e),i},(t,e)=>{if(!e?.length)throw TypeError("no paths specified to add to archive")});var iA=i(34589),iI=i(77598);let iN=process.env.__FAKE_PLATFORM__||process.platform,{O_CREAT:iF,O_TRUNC:iB,O_WRONLY:iC}=h.constants,iM=Number(process.env.__FAKE_FS_O_FILENAME__)||h.constants.UV_FS_O_FILEMAP||0,iP=iM|iB|iF|iC,iz="win32"===iN&&iM?t=>t<524288?iP:"w":()=>"w",iU=(t,e,i)=>{try{return j.lchownSync(t,e,i)}catch(t){if(t?.code!=="ENOENT")throw t}},ij=(t,e,i,s)=>{j.lchown(t,e,i,t=>{s(t&&t?.code!=="ENOENT"?t:null)})},iH=(t,e,i,s,r)=>{e.isDirectory()?iZ(U.resolve(t,e.name),i,s,h=>{if(h)return r(h);ij(U.resolve(t,e.name),i,s,r)}):ij(U.resolve(t,e.name),i,s,r)},iZ=(t,e,i,s)=>{j.readdir(t,{withFileTypes:!0},(r,h)=>{if(r){if("ENOENT"===r.code)return s();else if("ENOTDIR"!==r.code&&"ENOTSUP"!==r.code)return s(r)}if(r||!h.length)return ij(t,e,i,s);let n=h.length,o=null,a=r=>{if(!o){if(r)return s(o=r);if(0==--n)return ij(t,e,i,s)}};for(let s of h)iH(t,s,e,i,a)})},iG=(t,e,i,s)=>{e.isDirectory()&&iW(U.resolve(t,e.name),i,s),iU(U.resolve(t,e.name),i,s)},iW=(t,e,i)=>{let s;try{s=j.readdirSync(t,{withFileTypes:!0})}catch(s){if(s?.code==="ENOENT")return;if(s?.code==="ENOTDIR"||s?.code==="ENOTSUP")return iU(t,e,i);throw s}for(let r of s)iG(t,r,e,i);return iU(t,e,i)};var iV=i(51455);class iY extends Error{path;code;syscall="chdir";constructor(t,e){super(`${e}: Cannot cd into '${t}'`),this.path=t,this.code=e}get name(){return"CwdError"}}class i$ extends Error{path;symlink;syscall="symlink";code="TAR_SYMLINK_ERROR";constructor(t,e){super("TAR_SYMLINK_ERROR: Cannot extract through symbolic link"),this.symlink=t,this.path=e}get name(){return"SymlinkError"}}let iq=(t,e)=>{j.stat(t,(i,s)=>{(i||!s.isDirectory())&&(i=new iY(t,i?.code||"ENOTDIR")),e(i)})},iK=(t,e,i)=>{t=tJ(t);let s=e.umask??18,r=448|e.mode,h=(r&s)!=0,n=e.uid,o=e.gid,a="number"==typeof n&&"number"==typeof o&&(n!==e.processUid||o!==e.processGid),l=e.preserve,d=e.unlink,u=tJ(e.cwd),c=(e,s)=>{e?i(e):s&&a?iZ(s,n,o,t=>c(t)):h?j.chmod(t,r,i):i()};if(t===u)return iq(t,c);if(l)return iV.mkdir(t,{mode:r,recursive:!0}).then(t=>c(null,t??void 0),c);let m=tJ(U.relative(u,t)).split("/");iX(u,m,r,d,u,void 0,c)},iX=(t,e,i,s,r,h,n)=>{if(!e.length)return n(null,h);let o=e.shift(),a=tJ(U.resolve(t+"/"+o));j.mkdir(a,i,iQ(a,e,i,s,r,h,n))},iQ=(t,e,i,s,r,h,n)=>o=>{o?j.lstat(t,(a,l)=>{if(a)a.path=a.path&&tJ(a.path),n(a);else if(l.isDirectory())iX(t,e,i,s,r,h,n);else if(s)j.unlink(t,o=>{if(o)return n(o);j.mkdir(t,i,iQ(t,e,i,s,r,h,n))});else{if(l.isSymbolicLink())return n(new i$(t,t+"/"+e.join("/")));n(o)}}):(h=h||t,iX(t,e,i,s,r,h,n))},iJ=t=>{let e,i=!1;try{i=j.statSync(t).isDirectory()}catch(t){e=t?.code}finally{if(!i)throw new iY(t,e??"ENOTDIR")}},i0=(t,e)=>{let i;t=tJ(t);let s=e.umask??18,r=448|e.mode,h=(r&s)!=0,n=e.uid,o=e.gid,a="number"==typeof n&&"number"==typeof o&&(n!==e.processUid||o!==e.processGid),l=e.preserve,d=e.unlink,u=tJ(e.cwd),c=e=>{e&&a&&iW(e,n,o),h&&j.chmodSync(t,r)};if(t===u)return iJ(u),c();if(l)return c(j.mkdirSync(t,{mode:r,recursive:!0})??void 0);let m=tJ(U.relative(u,t)).split("/");for(let t=m.shift(),e=u;t&&(e+="/"+t);t=m.shift()){e=tJ(U.resolve(e));try{j.mkdirSync(e,r),i=i||e}catch(s){let t=j.lstatSync(e);if(t.isDirectory())continue;if(d){j.unlinkSync(e),j.mkdirSync(e,r),i=i||e;continue}if(t.isSymbolicLink())return new i$(e,e+"/"+m.join("/"))}}return c(i)},i1=Object.create(null),i2=new Set,i5=t=>{i2.has(t)?i2.delete(t):i1[t]=t.normalize("NFD"),i2.add(t);let e=i1[t],i=i2.size-1e4;if(i>1e3){for(let t of i2)if(i2.delete(t),delete i1[t],--i<=0)break}return e},i3="win32"===(process.env.TESTING_TAR_FAKE_PLATFORM||process.platform),i4=t=>t.split("/").slice(0,-1).reduce((t,e)=>{let i=t[t.length-1];return void 0!==i&&(e=(0,U.join)(i,e)),t.push(e||"/"),t},[]);class i8{#m=new Map;#p=new Map;#f=new Set;reserve(t,e){let i=new Set((t=i3?["win32 parallelization disabled"]:t.map(t=>ek((0,U.join)(i5(t))).toLowerCase())).map(t=>i4(t)).reduce((t,e)=>t.concat(e)));for(let s of(this.#p.set(e,{dirs:i,paths:t}),t)){let t=this.#m.get(s);t?t.push(e):this.#m.set(s,[e])}for(let t of i){let i=this.#m.get(t);if(i){let t=i[i.length-1];t instanceof Set?t.add(e):i.push(new Set([e]))}else this.#m.set(t,[new Set([e])])}return this.#y(e)}#b(t){let e=this.#p.get(t);if(!e)throw Error("function does not have any path reservations");return{paths:e.paths.map(t=>this.#m.get(t)),dirs:[...e.dirs].map(t=>this.#m.get(t))}}check(t){let{paths:e,dirs:i}=this.#b(t);return e.every(e=>e&&e[0]===t)&&i.every(e=>e&&e[0]instanceof Set&&e[0].has(t))}#y(t){return!this.#f.has(t)&&!!this.check(t)&&(this.#f.add(t),t(()=>this.#E(t)),!0)}#E(t){if(!this.#f.has(t))return!1;let e=this.#p.get(t);if(!e)throw Error("invalid reservation");let{paths:i,dirs:s}=e,r=new Set;for(let e of i){let i=this.#m.get(e);if(!i||i?.[0]!==t)continue;let s=i[1];if(!s){this.#m.delete(e);continue}if(i.shift(),"function"==typeof s)r.add(s);else for(let t of s)r.add(t)}for(let e of s){let i=this.#m.get(e),s=i?.[0];if(i&&s instanceof Set)if(1===s.size&&1===i.length){this.#m.delete(e);continue}else if(1===s.size){i.shift();let t=i[0];"function"==typeof t&&r.add(t)}else s.delete(t)}return this.#f.delete(t),r.forEach(t=>this.#y(t)),!0}}let i6=Symbol("onEntry"),i9=Symbol("checkFs"),i7=Symbol("checkFs2"),st=Symbol("isReusable"),se=Symbol("makeFs"),si=Symbol("file"),ss=Symbol("directory"),sr=Symbol("link"),sh=Symbol("symlink"),sn=Symbol("hardlink"),so=Symbol("unsupported"),sa=Symbol("checkPath"),sl=Symbol("mkdir"),sd=Symbol("onError"),su=Symbol("pending"),sc=Symbol("pend"),sm=Symbol("unpend"),sp=Symbol("ended"),sf=Symbol("maybeClose"),sy=Symbol("skip"),sb=Symbol("doChown"),sE=Symbol("uid"),sg=Symbol("gid"),sw=Symbol("checkedCwd"),sR="win32"===(process.env.TESTING_TAR_FAKE_PLATFORM||process.platform),s_=(t,e)=>{if(!sR)return j.unlink(t,e);let i=t+".DELETE."+(0,iI.randomBytes)(16).toString("hex");j.rename(t,i,t=>{if(t)return e(t);j.unlink(i,e)})},sS=t=>{if(!sR)return j.unlinkSync(t);let e=t+".DELETE."+(0,iI.randomBytes)(16).toString("hex");j.renameSync(t,e),j.unlinkSync(e)},sv=(t,e,i)=>void 0!==t&&t===t>>>0?t:void 0!==e&&e===e>>>0?e:i;class sO extends eT{[sp]=!1;[sw]=!1;[su]=0;reservations=new i8;transform;writable=!0;readable=!1;uid;gid;setOwner;preserveOwner;processGid;processUid;maxDepth;forceChown;win32;newer;keep;noMtime;preservePaths;unlink;cwd;strip;processUmask;umask;dmode;fmode;chmod;constructor(t={}){if(t.ondone=()=>{this[sp]=!0,this[sf]()},super(t),this.transform=t.transform,this.chmod=!!t.chmod,"number"==typeof t.uid||"number"==typeof t.gid){if("number"!=typeof t.uid||"number"!=typeof t.gid)throw TypeError("cannot set owner without number uid and gid");if(t.preserveOwner)throw TypeError("cannot preserve owner in archive and also set owner explicitly");this.uid=t.uid,this.gid=t.gid,this.setOwner=!0}else this.uid=void 0,this.gid=void 0,this.setOwner=!1;void 0===t.preserveOwner&&"number"!=typeof t.uid?this.preserveOwner=!!(process.getuid&&0===process.getuid()):this.preserveOwner=!!t.preserveOwner,this.processUid=(this.preserveOwner||this.setOwner)&&process.getuid?process.getuid():void 0,this.processGid=(this.preserveOwner||this.setOwner)&&process.getgid?process.getgid():void 0,this.maxDepth="number"==typeof t.maxDepth?t.maxDepth:1024,this.forceChown=!0===t.forceChown,this.win32=!!t.win32||sR,this.newer=!!t.newer,this.keep=!!t.keep,this.noMtime=!!t.noMtime,this.preservePaths=!!t.preservePaths,this.unlink=!!t.unlink,this.cwd=tJ(U.resolve(t.cwd||process.cwd())),this.strip=Number(t.strip)||0,this.processUmask=this.chmod?"number"==typeof t.processUmask?t.processUmask:process.umask():0,this.umask="number"==typeof t.umask?t.umask:this.processUmask,this.dmode=t.dmode||511&~this.umask,this.fmode=t.fmode||438&~this.umask,this.on("entry",t=>this[i6](t))}warn(t,e,i={}){return("TAR_BAD_ARCHIVE"===t||"TAR_ABORT"===t)&&(i.recoverable=!1),super.warn(t,e,i)}[sf](){this[sp]&&0===this[su]&&(this.emit("prefinish"),this.emit("finish"),this.emit("end"))}[sa](t){let e=tJ(t.path),i=e.split("/");if(this.strip){if(i.length<this.strip)return!1;if("Link"===t.type){let e=tJ(String(t.linkpath)).split("/");if(!(e.length>=this.strip))return!1;t.linkpath=e.slice(this.strip).join("/")}i.splice(0,this.strip),t.path=i.join("/")}if(isFinite(this.maxDepth)&&i.length>this.maxDepth)return this.warn("TAR_ENTRY_ERROR","path excessively deep",{entry:t,path:e,depth:i.length,maxDepth:this.maxDepth}),!1;if(!this.preservePaths){if(i.includes("..")||sR&&/^[a-z]:\.\.$/i.test(i[0]??""))return this.warn("TAR_ENTRY_ERROR","path contains '..'",{entry:t,path:e}),!1;let[s,r]=eF(e);s&&(t.path=String(r),this.warn("TAR_ENTRY_INFO",`stripping ${s} from absolute path`,{entry:t,path:e}))}if(U.isAbsolute(t.path)?t.absolute=tJ(U.resolve(t.path)):t.absolute=tJ(U.resolve(this.cwd,t.path)),!this.preservePaths&&"string"==typeof t.absolute&&0!==t.absolute.indexOf(this.cwd+"/")&&t.absolute!==this.cwd)return this.warn("TAR_ENTRY_ERROR","path escaped extraction target",{entry:t,path:tJ(t.path),resolvedPath:t.absolute,cwd:this.cwd}),!1;if(t.absolute===this.cwd&&"Directory"!==t.type&&"GNUDumpDir"!==t.type)return!1;if(this.win32){let{root:e}=U.win32.parse(String(t.absolute));t.absolute=e+ez(String(t.absolute).slice(e.length));let{root:i}=U.win32.parse(t.path);t.path=i+ez(t.path.slice(i.length))}return!0}[i6](t){if(!this[sa](t))return t.resume();switch(iA.equal(typeof t.absolute,"string"),t.type){case"Directory":case"GNUDumpDir":t.mode&&(t.mode=448|t.mode);case"File":case"OldFile":case"ContiguousFile":case"Link":case"SymbolicLink":return this[i9](t);default:return this[so](t)}}[sd](t,e){"CwdError"===t.name?this.emit("error",t):(this.warn("TAR_ENTRY_ERROR",t,{entry:e}),this[sm](),e.resume())}[sl](t,e,i){iK(tJ(t),{uid:this.uid,gid:this.gid,processUid:this.processUid,processGid:this.processGid,umask:this.processUmask,preserve:this.preservePaths,unlink:this.unlink,cwd:this.cwd,mode:e},i)}[sb](t){return this.forceChown||this.preserveOwner&&("number"==typeof t.uid&&t.uid!==this.processUid||"number"==typeof t.gid&&t.gid!==this.processGid)||"number"==typeof this.uid&&this.uid!==this.processUid||"number"==typeof this.gid&&this.gid!==this.processGid}[sE](t){return sv(this.uid,t.uid,this.processUid)}[sg](t){return sv(this.gid,t.gid,this.processGid)}[si](t,e){let i="number"==typeof t.mode?4095&t.mode:this.fmode,s=new P(String(t.absolute),{flags:iz(t.size),mode:i,autoClose:!1});s.on("error",i=>{s.fd&&j.close(s.fd,()=>{}),s.write=()=>!0,this[sd](i,t),e()});let r=1,h=i=>{if(i){s.fd&&j.close(s.fd,()=>{}),this[sd](i,t),e();return}0==--r&&void 0!==s.fd&&j.close(s.fd,i=>{i?this[sd](i,t):this[sm](),e()})};s.on("finish",()=>{let e=String(t.absolute),i=s.fd;if("number"==typeof i&&t.mtime&&!this.noMtime){r++;let s=t.atime||new Date,n=t.mtime;j.futimes(i,s,n,t=>t?j.utimes(e,s,n,e=>h(e&&t)):h())}if("number"==typeof i&&this[sb](t)){r++;let s=this[sE](t),n=this[sg](t);"number"==typeof s&&"number"==typeof n&&j.fchown(i,s,n,t=>t?j.chown(e,s,n,e=>h(e&&t)):h())}h()});let n=this.transform&&this.transform(t)||t;n!==t&&(n.on("error",i=>{this[sd](i,t),e()}),t.pipe(n)),n.pipe(s)}[ss](t,e){let i="number"==typeof t.mode?4095&t.mode:this.dmode;this[sl](String(t.absolute),i,i=>{if(i){this[sd](i,t),e();return}let s=1,r=()=>{0==--s&&(e(),this[sm](),t.resume())};t.mtime&&!this.noMtime&&(s++,j.utimes(String(t.absolute),t.atime||new Date,t.mtime,r)),this[sb](t)&&(s++,j.chown(String(t.absolute),Number(this[sE](t)),Number(this[sg](t)),r)),r()})}[so](t){t.unsupported=!0,this.warn("TAR_ENTRY_UNSUPPORTED",`unsupported entry type: ${t.type}`,{entry:t}),t.resume()}[sh](t,e){this[sr](t,String(t.linkpath),"symlink",e)}[sn](t,e){let i=tJ(U.resolve(this.cwd,String(t.linkpath)));this[sr](t,i,"link",e)}[sc](){this[su]++}[sm](){this[su]--,this[sf]()}[sy](t){this[sm](),t.resume()}[st](t,e){return"File"===t.type&&!this.unlink&&e.isFile()&&e.nlink<=1&&!sR}[i9](t){this[sc]();let e=[t.path];t.linkpath&&e.push(t.linkpath),this.reservations.reserve(e,e=>this[i7](t,e))}[i7](t,e){let i=t=>{e(t)},s=()=>{if(t.absolute!==this.cwd){let e=tJ(U.dirname(String(t.absolute)));if(e!==this.cwd)return this[sl](e,this.dmode,e=>{if(e){this[sd](e,t),i();return}r()})}r()},r=()=>{j.lstat(String(t.absolute),(e,s)=>{if(s&&(this.keep||this.newer&&s.mtime>(t.mtime??s.mtime))){this[sy](t),i();return}if(e||this[st](t,s))return this[se](null,t,i);if(s.isDirectory()){if("Directory"===t.type){let e=this.chmod&&t.mode&&(4095&s.mode)!==t.mode,r=e=>this[se](e??null,t,i);return e?j.chmod(String(t.absolute),Number(t.mode),r):r()}if(t.absolute!==this.cwd)return j.rmdir(String(t.absolute),e=>this[se](e??null,t,i))}if(t.absolute===this.cwd)return this[se](null,t,i);s_(String(t.absolute),e=>this[se](e??null,t,i))})};this[sw]?s():this[sl](this.cwd,this.dmode,e=>{if(e){this[sd](e,t),i();return}this[sw]=!0,s()})}[se](t,e,i){if(t){this[sd](t,e),i();return}switch(e.type){case"File":case"OldFile":case"ContiguousFile":return this[si](e,i);case"Link":return this[sn](e,i);case"SymbolicLink":return this[sh](e,i);case"Directory":case"GNUDumpDir":return this[ss](e,i)}}[sr](t,e,i,s){j[i](e,String(t.absolute),e=>{e?this[sd](e,t):(this[sm](),t.resume()),s()})}}let sT=t=>{try{return[null,t()]}catch(t){return[t,null]}};class sk extends sO{sync=!0;[se](t,e){return super[se](t,e,()=>{})}[i9](t){if(!this[sw]){let e=this[sl](this.cwd,this.dmode);if(e)return this[sd](e,t);this[sw]=!0}if(t.absolute!==this.cwd){let e=tJ(U.dirname(String(t.absolute)));if(e!==this.cwd){let i=this[sl](e,this.dmode);if(i)return this[sd](i,t)}}let[e,i]=sT(()=>j.lstatSync(String(t.absolute)));if(i&&(this.keep||this.newer&&i.mtime>(t.mtime??i.mtime)))return this[sy](t);if(e||this[st](t,i))return this[se](null,t);if(i.isDirectory()){if("Directory"===t.type){let[e]=this.chmod&&t.mode&&(4095&i.mode)!==t.mode?sT(()=>{j.chmodSync(String(t.absolute),Number(t.mode))}):[];return this[se](e,t)}let[e]=sT(()=>j.rmdirSync(String(t.absolute)));this[se](e,t)}let[s]=t.absolute===this.cwd?[]:sT(()=>sS(String(t.absolute)));this[se](s,t)}[si](t,e){let i,s="number"==typeof t.mode?4095&t.mode:this.fmode,r=s=>{let r;try{j.closeSync(i)}catch(t){r=t}(s||r)&&this[sd](s||r,t),e()};try{i=j.openSync(String(t.absolute),iz(t.size),s)}catch(t){return r(t)}let h=this.transform&&this.transform(t)||t;h!==t&&(h.on("error",e=>this[sd](e,t)),t.pipe(h)),h.on("data",t=>{try{j.writeSync(i,t,0,t.length)}catch(t){r(t)}}),h.on("end",()=>{let e=null;if(t.mtime&&!this.noMtime){let s=t.atime||new Date,r=t.mtime;try{j.futimesSync(i,s,r)}catch(i){try{j.utimesSync(String(t.absolute),s,r)}catch(t){e=i}}}if(this[sb](t)){let s=this[sE](t),r=this[sg](t);try{j.fchownSync(i,Number(s),Number(r))}catch(i){try{j.chownSync(String(t.absolute),Number(s),Number(r))}catch(t){e=e||i}}}r(e)})}[ss](t,e){let i="number"==typeof t.mode?4095&t.mode:this.dmode,s=this[sl](String(t.absolute),i);if(s){this[sd](s,t),e();return}if(t.mtime&&!this.noMtime)try{j.utimesSync(String(t.absolute),t.atime||new Date,t.mtime)}catch(t){}if(this[sb](t))try{j.chownSync(String(t.absolute),Number(this[sE](t)),Number(this[sg](t)))}catch(t){}e(),t.resume()}[sl](t,e){try{return i0(tJ(t),{uid:this.uid,gid:this.gid,processUid:this.processUid,processGid:this.processGid,umask:this.processUmask,preserve:this.preservePaths,unlink:this.unlink,cwd:this.cwd,mode:e})}catch(t){return t}}[sr](t,e,i,s){let r=`${i}Sync`;try{j[r](e,String(t.absolute)),s(),t.resume()}catch(e){return this[sd](e,t)}}}let sL=X(t=>{let e=new sk(t),i=t.file,s=j.statSync(i);new M(i,{readSize:t.maxReadSize||0x1000000,size:s.size}).pipe(e)},(t,e)=>{let i=new sO(t),s=t.maxReadSize||0x1000000,r=t.file;return new Promise((t,e)=>{i.on("error",e),i.on("close",t),j.stat(r,(t,h)=>{if(t)e(t);else{let t=new C(r,{readSize:s,size:h.size});t.on("error",e),t.pipe(i)}})})},t=>new sk(t),t=>new sO(t),(t,e)=>{e?.length&&eD(t,e)}),sD=(t,e,i,s,r)=>{let h=new z(t.file,{fd:s,start:i});e.pipe(h),sx(e,r)},sx=(t,e)=>{e.forEach(e=>{"@"===e.charAt(0)?ex({file:U.resolve(t.cwd,e.slice(1)),sync:!0,noResume:!0,onReadEntry:e=>t.add(e)}):t.add(e)}),t.end()},sA=async(t,e)=>{for(let i=0;i<e.length;i++){let s=String(e[i]);"@"===s.charAt(0)?await ex({file:U.resolve(String(t.cwd),s.slice(1)),noResume:!0,onReadEntry:e=>t.add(e)}):t.add(s)}t.end()},sI=X((t,e)=>{let i,s,r=new ik(t),h=!0;try{try{i=j.openSync(t.file,"r+")}catch(e){if(e?.code==="ENOENT")i=j.openSync(t.file,"w+");else throw e}let n=j.fstatSync(i),o=Buffer.alloc(512);t:for(s=0;s<n.size;s+=512){for(let t=0,e=0;t<512;t+=e){if(e=j.readSync(i,o,t,o.length-t,s+t),0===s&&31===o[0]&&139===o[1])throw Error("cannot append to compressed archives");if(!e)break t}let e=new tN(o);if(!e.cksumValid)break;let r=512*Math.ceil((e.size||0)/512);if(s+r+512>n.size)break;s+=r,t.mtimeCache&&e.mtime&&t.mtimeCache.set(String(e.path),e.mtime)}h=!1,sD(t,r,s,i,e)}finally{if(h)try{j.closeSync(i)}catch(t){}}},(t,e)=>{e=Array.from(e);let i=new iT(t),s=(e,i,s)=>{let r=(t,i)=>{t?j.close(e,e=>s(t)):s(null,i)},h=0;if(0===i)return r(null,0);let n=0,o=Buffer.alloc(512),a=(s,l)=>{if(s||void 0===l)return r(s);if((n+=l)<512&&l)return j.read(e,o,n,o.length-n,h+n,a);if(0===h&&31===o[0]&&139===o[1])return r(Error("cannot append to compressed archives"));if(n<512)return r(null,h);let d=new tN(o);if(!d.cksumValid)return r(null,h);let u=512*Math.ceil((d.size??0)/512);if(h+u+512>i||(h+=u+512)>=i)return r(null,h);t.mtimeCache&&d.mtime&&t.mtimeCache.set(String(d.path),d.mtime),n=0,j.read(e,o,0,512,h,a)};j.read(e,o,0,512,h,a)};return new Promise((r,h)=>{i.on("error",h);let n="r+",o=(a,l)=>a&&"ENOENT"===a.code&&"r+"===n?(n="w+",j.open(t.file,n,o)):a||!l?h(a):void j.fstat(l,(n,o)=>{if(n)return j.close(l,()=>h(n));s(l,o.size,(s,n)=>{if(s)return h(s);let o=new P(t.file,{fd:l,start:n});i.pipe(o),o.on("error",h),o.on("close",r),sA(i,e)})});j.open(t.file,n,o)})},()=>{throw TypeError("file is required")},()=>{throw TypeError("file is required")},(t,e)=>{if(!$(t))throw TypeError("file is required");if(t.gzip||t.brotli||t.zstd||t.file.endsWith(".br")||t.file.endsWith(".tbr"))throw TypeError("cannot append to compressed archives");if(!e?.length)throw TypeError("no paths specified to add/replace")}),sN=X(sI.syncFile,sI.asyncFile,sI.syncNoFile,sI.asyncNoFile,(t,e=[])=>{sI.validate?.(t,e),sF(t)}),sF=t=>{let e=t.filter;t.mtimeCache||(t.mtimeCache=new Map),t.filter=e?(i,s)=>e(i,s)&&!((t.mtimeCache?.get(i)??s.mtime??0)>(s.mtime??0)):(e,i)=>!((t.mtimeCache?.get(e)??i.mtime??0)>(i.mtime??0))}}};