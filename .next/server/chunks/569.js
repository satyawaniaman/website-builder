"use strict";exports.id=569,exports.ids=[569],exports.modules={28569:(e,t,r)=>{r.d(t,{JSONSchemaToZod:()=>s});var i=r(75738),a=r(3513);class s{static convert(e){return this.parseSchema(e)}static matchesCondition(e,t){if(!t.properties)return!0;if("object"!=typeof e||null===e||Array.isArray(e))return!1;for(let[r,i]of Object.entries(t.properties)){if(!(r in e)){if("const"in i)return!1;continue}let t=e[r];if("const"in i&&t!==i.const||"minimum"in i&&"number"==typeof t&&t<i.minimum||"maximum"in i&&"number"==typeof t&&t>i.maximum)return!1}return!0}static validateConditionalSchema(e,t,r){this.validateRequiredProperties(e,t,r),this.validatePropertyPatterns(e,t,r),this.validateNestedConditions(e,t,r)}static validateRequiredProperties(e,t,r){if(t.required){if("object"!=typeof e||null===e){for(let e of t.required)r.addIssue({code:i.eq.custom,message:`Required property '${e}' is missing`,path:[e]});return}for(let a of t.required)a in e||r.addIssue({code:i.eq.custom,message:`Required property '${a}' is missing`,path:[a]})}}static validatePropertyPatterns(e,t,r){if(!(!t.properties||"object"!=typeof e||null===e||Array.isArray(e)))for(let[a,s]of Object.entries(t.properties)){if(!(a in e))continue;let t=e[a];s.pattern&&"string"==typeof t&&(new RegExp(s.pattern).test(t)||r.addIssue({code:i.eq.custom,message:`String '${t}' does not match pattern '${s.pattern}'`,path:[a]}))}}static validateNestedConditions(e,t,r){t.if&&t.then&&(this.matchesCondition(e,t.if)?this.validateConditionalSchema(e,t.then,r):t.else&&this.validateConditionalSchema(e,t.else,r))}static parseSchema(e){return Array.isArray(e.type)?this.handleTypeArray(e):e.oneOf||e.anyOf||e.allOf?this.parseCombinator(e):e.if&&e.then||e.properties&&(!e.type||"object"===e.type)?this.parseObject(e):this.handleSingleType(e)}static handleTypeArray(e){if(!Array.isArray(e.type))throw Error("Expected schema.type to be an array");return e.type.includes("null")?this.handleNullableType(e):this.createUnionFromTypes(e.type,e)}static handleNullableType(e){if(!Array.isArray(e.type))throw Error("Expected schema.type to be an array");let t={...e};return(t.type=e.type.filter(e=>"null"!==e),1===t.type.length)?this.handleSingleType({...e,type:t.type[0]}).nullable():this.parseSchema(t).nullable()}static createUnionFromTypes(e,t){let r=e.map(e=>{let r={...t,type:e};return this.parseSchema(r)});return a.KC(r)}static handleSingleType(e){if(void 0===e.type)return e.oneOf||e.anyOf||e.allOf?this.parseCombinator(e):e.properties?this.parseObject(e):a.bz();switch(e.type){case"string":return this.parseString(e);case"number":case"integer":return this.parseNumberSchema(e);case"boolean":return a.zM();case"array":return this.parseArray(e);case"object":return this.parseObject(e);default:throw Error("Unsupported schema type")}}static parseNumberSchema(e){let t=a.ai(),r=t;return this.applyNumberBounds(t,e),this.applyNumberMultipleOf(t,e),this.applyNumberEnum(t,e),this.applyIntegerConstraint(t,e)}static applyNumberBounds(e,t){let r=e;return void 0!==t.minimum&&(r=t.exclusiveMinimum?r.gt(t.minimum):r.gte(t.minimum)),void 0!==t.maximum&&(r=t.exclusiveMaximum?r.lt(t.maximum):r.lte(t.maximum)),r}static applyNumberMultipleOf(e,t){return void 0===t.multipleOf?e:e.refine(e=>e%t.multipleOf==0,{message:`Number must be a multiple of ${t.multipleOf}`})}static applyNumberEnum(e,t){if(!t.enum)return e;let r=t.enum.filter(e=>"number"==typeof e);return 0===r.length?e:e.refine(e=>r.includes(e),{message:`Number must be one of: ${r.join(", ")}`})}static applyIntegerConstraint(e,t){return"integer"!==t.type?e:e.refine(e=>Number.isInteger(e),{message:"Number must be an integer"})}static parseString(e){let t=a.Yj(),r=t;return e.format?this.applyStringFormat(t,e):(r=this.applyStringPattern(t,e),r=this.applyStringLength(t,e),r=this.applyStringEnum(t,e))}static applyStringFormat(e,t){if(!t.format)return e;switch(t.format){case"email":return e.email();case"date-time":return e.datetime();case"uri":return e.url();case"uuid":return e.uuid();case"date":return e.date();default:return e}}static applyStringPattern(e,t){if(!t.pattern)return e;let r=new RegExp(t.pattern);return e.regex(r,{message:`String must match pattern: ${t.pattern}`})}static applyStringLength(e,t){let r=e;return void 0!==t.minLength&&(e=e.min(t.minLength)),void 0!==t.maxLength&&(e=e.max(t.maxLength)),r}static applyStringEnum(e,t){return t.enum?e.refine(e=>t.enum?.includes(e),{message:`Value must be one of: ${t.enum?.join(", ")}`}):e}static parseArray(e){if(Array.isArray(e.items)){let t=e.items.map(e=>this.parseSchema(e));return a.KC(t)}let t=e.items?this.parseSchema(e.items):a.bz(),r=a.YO(t),i=r;return this.applyArrayConstraints(r,e)}static applyArrayConstraints(e,t){return(void 0!==t.minItems&&(e=e.min(t.minItems)),void 0!==t.maxItems&&(e=e.max(t.maxItems)),t.uniqueItems)?e.refine(e=>new Set(e).size===e.length,{message:"Array items must be unique"}):e}static parseObject(e){if(e.if&&e.then)return this.parseConditional(e);let t={};return this.processObjectProperties(e,t),this.processAdditionalProperties(e,a.Ik(t))}static processObjectProperties(e,t){let r=new Set(e.required||[]);if(e.properties)for(let[i,a]of Object.entries(e.properties)){let e=this.parseSchema(a);t[i]=r.has(i)?e:e.optional()}}static processAdditionalProperties(e,t){if(!0===e.additionalProperties)return t.passthrough();if(!e.additionalProperties||"object"!=typeof e.additionalProperties)return t.strict();{let r=this.parseSchema(e.additionalProperties);return t.catchall(r)}}static parseConditional(e){let t=this.createBaseObjectSchema(e),r=e.if,i=e.then,a=e.else;return t.superRefine((t,s)=>{let n=this.applyDefaultValues(t,e);this.matchesCondition(n,r)?this.validateConditionalSchema(n,i,s):a&&this.validateConditionalSchema(n,a,s)})}static createBaseObjectSchema(e){let t={},r=new Set(e.required||[]);for(let[i,a]of Object.entries(e.properties||{})){let e=this.parseSchema(a);t[i]=r.has(i)?e:e.optional()}let i=a.Ik(t);return this.processAdditionalProperties(e,i)}static applyDefaultValues(e,t){if("object"!=typeof e||null===e||Array.isArray(e))return e;let r={...e};if(!t.properties)return r;for(let[e,i]of Object.entries(t.properties))!(e in r)&&"default"in i&&(r[e]=i.default);return r}static parseCombinator(e){if(e.oneOf)return this.parseOneOf(e.oneOf);if(e.anyOf)return this.parseAnyOf(e.anyOf);if(e.allOf)return this.parseAllOf(e.allOf);throw Error("Unsupported schema type")}static parseOneOf(e){return this.createUnionFromSchemas(e)}static parseAnyOf(e){return this.createUnionFromSchemas(e)}static createUnionFromSchemas(e){if(0===e.length)return a.bz();if(1===e.length)return this.parseSchema(e[0]);let t=[];for(let r of e)"null"===r.type?t.push(a.ch()):t.push(this.parseSchema(r));return t.length>=2?a.KC(t):1===t.length?t[0]:a.bz()}static parseAllOf(e){if(0===e.length)return a.bz();if(1===e.length)return this.parseSchema(e[0]);let t=e.reduce((e,t)=>this.mergeSchemas(e,t));return this.parseSchema(t)}static mergeSchemas(e,t){let r={...e,...t};return e.properties&&t.properties&&(r.properties={...e.properties,...t.properties}),e.required&&t.required&&(r.required=[...new Set([...e.required,...t.required])]),r}}}};